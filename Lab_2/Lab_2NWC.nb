(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     64065,       1612]
NotebookOptionsPosition[     63465,       1588]
NotebookOutlinePosition[     63813,       1603]
CellTagsIndexPosition[     63770,       1600]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"TT", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", "2", ",", "3", ",", "4", ",", "6", ",", "8", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "2", ",", "0", ",", "2", ",", "4", ",", "6", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "4", ",", "4", ",", "2", ",", "0", ",", "2", ",", "2", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "6", ",", "6", ",", "4", ",", "4", ",", "2", ",", "0", ",", "0"}], 
       "}"}]}], "}"}]}], ";"}],
  FontSize->16], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"RL", "=", 
    RowBox[{"{", 
     RowBox[{"128", ",", "128", ",", "512", ",", "64"}], "}"}]}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"CL", "=", 
     RowBox[{"{", 
      RowBox[{
      "56", ",", "56", ",", "256", ",", "64", ",", "32", ",", "128", ",", 
       "240"}], "}"}]}], ";"}],
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], 
  RowBox[{
   StyleBox[
    StyleBox[
     RowBox[{"(", "*"}]],
    FontSize->16], 
   RowBox[{
    StyleBox[
     RowBox[{"TT", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"10", ",", " ", "5", ",", " ", "12"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"23", ",", " ", "28", ",", " ", "33"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"43", ",", " ", "40", ",", " ", "39"}], "}"}]}], "}"}]}],
     FontSize->16], 
    StyleBox[";",
     FontSize->16], "\n", 
    StyleBox[
     RowBox[{"RL", "=", 
      RowBox[{"{", 
       RowBox[{"100", ",", " ", "120", ",", " ", "90"}], "}"}]}],
     FontSize->16], 
    StyleBox[";",
     FontSize->16], "\[IndentingNewLine]", 
    StyleBox[
     RowBox[{"CL", "=", 
      RowBox[{"{", 
       RowBox[{"180", ",", " ", "90", ",", " ", "40"}], "}"}]}],
     FontSize->16], 
    StyleBox[";",
     FontSize->16]}], 
   StyleBox[
    RowBox[{
     StyleBox["*",
      FontSize->16], 
     StyleBox[")",
      FontSize->16]}]]}], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "TT", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"rowsCount", "=", 
     RowBox[{"Length", "[", "RL", "]"}]}], ";"}],
   FontSize->16], "\n"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"colsCount", "=", 
    RowBox[{"Length", "[", "CL", "]"}]}], ";"}],
  FontSize->16], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"Clear", "[", "basis", "]"}], ";"}],
  FontSize->16], "\n", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"Clear", "[", "values", "]"}], ";"}],
   FontSize->16], 
  StyleBox["\n",
   FontSize->16], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"fnFindBasisNWCMethod", "[", 
      RowBox[{"inTT_", ",", "inRL_", ",", "inCL_"}], "]"}],
     FontSize->16], 
    StyleBox[":=",
     FontSize->16], 
    RowBox[{
     StyleBox["Module",
      FontSize->16], 
     StyleBox["[",
      FontSize->16], 
     RowBox[{
      StyleBox[
       RowBox[{"{", 
        RowBox[{
        "locRL", ",", "locCL", ",", "locRowsCount", ",", "locColsCount", ",", 
         "locVarBasis", ",", "locVarValues", ",", "locCurrentRow", ",", 
         "locCurrentCol", ",", "locVarsChosen", ",", "locVarsToChoose", ",", 
         "locPickedVarValue"}], "}"}],
       FontSize->16], 
      StyleBox[",",
       FontSize->16], 
      RowBox[{
       StyleBox[
        RowBox[{"locRL", "=", "inRL"}],
        FontSize->16], 
       StyleBox[";",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox[
        RowBox[{"locCL", "=", "inCL"}],
        FontSize->16], 
       StyleBox[";",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox[
        RowBox[{"locRowsCount", "=", 
         RowBox[{"Length", "[", "inRL", "]"}]}],
        FontSize->16], 
       StyleBox[";",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox[
        RowBox[{"locColsCount", "=", 
         RowBox[{"Length", "[", "inCL", "]"}]}],
        FontSize->16], 
       StyleBox[";",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox[
        RowBox[{"locVarBasis", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "locColsCount", "}"}]}], "]"}], ",", 
           RowBox[{"{", "locRowsCount", "}"}]}], "]"}]}],
        FontSize->16], 
       StyleBox[";",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox[
        RowBox[{"locVarValues", "=", "locVarBasis"}],
        FontSize->16], 
       StyleBox[";",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox[
        RowBox[{"locCurrentRow", "=", "1"}],
        FontSize->16], 
       StyleBox[";",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox[
        RowBox[{"locCurrentCol", "=", "1"}],
        FontSize->16], 
       StyleBox[";",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox[
        RowBox[{"locVarsChosen", "=", "0"}],
        FontSize->16], 
       StyleBox[";",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox[
        RowBox[{"locVarsToChoose", "=", 
         RowBox[{"locRowsCount", "+", "locColsCount", "-", "1"}]}],
        FontSize->16], 
       StyleBox[";",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       RowBox[{
        StyleBox["While",
         FontSize->16], 
        StyleBox["[",
         FontSize->16], 
        RowBox[{
         StyleBox[
          RowBox[{"locVarsChosen", "<", "locVarsToChoose"}],
          FontSize->16], 
         StyleBox[",",
          FontSize->16], 
         StyleBox["\[IndentingNewLine]",
          FontSize->16], 
         StyleBox["\[IndentingNewLine]",
          FontSize->16], 
         RowBox[{
          StyleBox[
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"locCurrentRow", "\[Equal]", "locRowsCount"}], ",", 
             RowBox[{"locPickedVarValue", "=", 
              RowBox[{"locCL", "[", 
               RowBox[{"[", "locCurrentCol", "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"locCurrentCol", "\[Equal]", "locColsCount"}], ",", 
                RowBox[{"locPickedVarValue", "=", 
                 RowBox[{"locRL", "[", 
                  RowBox[{"[", "locCurrentRow", "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"find", " ", "min"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"locPickedVarValue", "=", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"locRL", "[", 
                    RowBox[{"[", "locCurrentRow", "]"}], "]"}], ",", 
                    RowBox[{"locCL", "[", 
                    RowBox[{"[", "locCurrentCol", "]"}], "]"}]}], "]"}]}], 
                 ";"}]}], "]"}], ";"}]}], "]"}],
           FontSize->16], 
          StyleBox[";",
           FontSize->16], 
          StyleBox["\[IndentingNewLine]",
           FontSize->16], 
          StyleBox["\[IndentingNewLine]",
           FontSize->16], 
          StyleBox[
           RowBox[{
            RowBox[{"locVarBasis", "[", 
             RowBox[{"[", 
              RowBox[{"locCurrentRow", ",", "locCurrentCol"}], "]"}], "]"}], 
            "=", "1"}],
           FontSize->16], 
          StyleBox[";",
           FontSize->16], 
          StyleBox["\[IndentingNewLine]",
           FontSize->16], 
          StyleBox["\[IndentingNewLine]",
           FontSize->16], 
          StyleBox[
           RowBox[{
            RowBox[{"locVarValues", "[", 
             RowBox[{"[", 
              RowBox[{"locCurrentRow", ",", "locCurrentCol"}], "]"}], "]"}], 
            "=", "locPickedVarValue"}],
           FontSize->16], 
          StyleBox[";",
           FontSize->16], 
          StyleBox["\[IndentingNewLine]",
           FontSize->16], 
          RowBox[{
           StyleBox[
            RowBox[{
             StyleBox["(",
              FontSize->16], 
             StyleBox["*",
              FontSize->16]}]], 
           StyleBox[
            RowBox[{"edit", " ", "limits"}],
            FontSize->16], 
           StyleBox[
            StyleBox[
             RowBox[{"*", ")"}]],
            FontSize->16]}], 
          StyleBox["\[IndentingNewLine]",
           FontSize->16], 
          StyleBox["\[IndentingNewLine]",
           FontSize->16], 
          StyleBox[
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"locCurrentRow", "\[LessEqual]", "locRowsCount"}], "&&", 
              RowBox[{
               RowBox[{"locRL", "[", 
                RowBox[{"[", "locCurrentRow", "]"}], "]"}], "\[Equal]", 
               "locPickedVarValue"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"locRL", "[", 
                RowBox[{"[", "locCurrentRow", "]"}], "]"}], "=", "0"}], ";", 
              RowBox[{
               RowBox[{"locCL", "[", 
                RowBox[{"[", "locCurrentCol", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"locCL", "[", 
                 RowBox[{"[", "locCurrentCol", "]"}], "]"}], "-", 
                "locPickedVarValue"}]}], ";", 
              RowBox[{"locCurrentRow", "++"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"locCL", "[", 
                RowBox[{"[", "locCurrentCol", "]"}], "]"}], "=", "0"}], ";", 
              RowBox[{
               RowBox[{"locRL", "[", 
                RowBox[{"[", "locCurrentRow", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"locRL", "[", 
                 RowBox[{"[", "locCurrentRow", "]"}], "]"}], "-", 
                "locPickedVarValue"}]}], ";", 
              RowBox[{"locCurrentCol", "++"}]}]}], "]"}],
           FontSize->16], 
          StyleBox[";",
           FontSize->16], 
          StyleBox["\[IndentingNewLine]",
           FontSize->16], 
          StyleBox["\[IndentingNewLine]",
           FontSize->16], 
          StyleBox[
           RowBox[{"locVarsChosen", "++"}],
           FontSize->16], 
          StyleBox[";",
           FontSize->16]}]}], 
        StyleBox["]",
         FontSize->16]}], 
       StyleBox[";",
        FontSize->16], 
       StyleBox["\[IndentingNewLine]",
        FontSize->16], 
       StyleBox[
        RowBox[{"{", 
         RowBox[{"locVarBasis", ",", "locVarValues"}], "}"}],
        FontSize->16]}]}], 
     StyleBox["]",
      FontSize->16]}]}], 
   StyleBox[";",
    FontSize->16]}], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "\:041d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:0435", " ", 
     "\:0441\:043b\:0435\:0434\:0443\:044e\:0449\:0435\:0439", " ", 
     "\:0432\:043a\:043b\:044e\:0447\:0430\:0435\:043c\:043e\:0439", " ", 
     "\:0432", " ", "\:0431\:0430\:0437\:0438\:0441", " ", 
     "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ", 
     "\:043c\:0435\:0442\:043e\:0434\:043e\:043c", " ", 
     "\:043f\:043e\:0442\:0435\:043d\:0446\:0438\:0430\:043b\:043e\:0432"}], 
    "*)"}],
   FontSize->16]}], "\n", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"fnFindNextBasisVar", "[", 
      RowBox[{"inTT_", ",", "inBasis_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locRowsCount", ",", "locColsCount", ",", "locCoeffs", ",", 
         "locValues", ",", "locI", ",", "locJ", ",", "locCurrentRow", ",", 
         "locPotentials", ",", "locMaxEstimate", ",", "locNewBasisVarRow", 
         ",", "locNewBasisVarCol", ",", "locEstimate", ",", "locResult"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"locRowsCount", "=", 
         RowBox[{"Length", "[", "inTT", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"locColsCount", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"inTT", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "\:0422\:0430\:0431\:043b\:0438\:0446\:0430", " ", 
          "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\:043d\:0442\
\:043e\:0432", " ", "\:0434\:043b\:044f", " ", 
          "\:0441\:0438\:0441\:0442\:0435\:043c\:044b", " ", 
          "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439", " ", 
          "\:043f\:043e", " ", 
          "\:043d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:044e", " ",
           "\:043f\:043e\:0442\:0435\:043d\:0446\:0438\:0430\:043b\:043e\:0432\
"}], "*)"}], 
        RowBox[{"locCoeffs", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"locRowsCount", "+", "locColsCount"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"locRowsCount", "+", "locColsCount"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "\:0417\:043d\:0430\:0447\:0435\:043d\:0438\:044f", " ", 
          "\:043f\:0440\:0430\:0432\:043e\:0439", " ", 
          "\:0447\:0430\:0441\:0442\:0438", " ", 
          "\:0441\:0438\:0441\:0442\:0435\:043c\:044b", " ", 
          "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439"}], "*)"}], 
        RowBox[{"locValues", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"locRowsCount", "+", "locColsCount"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"locCurrentRow", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0418\:0437\:0443\:0447\:0430\:0435\:043c", " ", "\:0432", " ", 
           "\:0446\:0438\:043a\:043b\:0435", " ", "\:0432\:0441\:0435", " ", 
           "\:0431\:0430\:0437\:0438\:0441\:043d\:044b\:0435", " ", 
           "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0435"}], 
          ",", 
          RowBox[{
          "\:0444\:043e\:0440\:043c\:0438\:0440\:0443\:0435\:043c", " ", 
           "\:043c\:0430\:0442\:0440\:0438\:0446\:0443", " ", 
           "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\:043d\:0442\
\:043e\:0432", " ", "\:0434\:043b\:044f", " ", 
           "\:0440\:0435\:0448\:0435\:043d\:0438\:044f", " ", 
           "\:0441\:0438\:0441\:0442\:0435\:043c\:044b", " ", 
           "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439", " ", 
           "\:0434\:043b\:044f", " ", 
           "\:043d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:044f", 
           " ", "\:043f\:043e\:0442\:0435\:043d\:0446\:0438\:0430\:043b\:043e\
\:0432"}]}], "*)"}], 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"locI", "=", "1"}], ",", 
          RowBox[{"locI", "\[LessEqual]", "locRowsCount"}], ",", 
          RowBox[{"locI", "++"}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"locJ", "=", "1"}], ",", 
             RowBox[{"locJ", "\[LessEqual]", "locColsCount"}], ",", 
             RowBox[{"locJ", "++"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"inBasis", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "locJ"}], "]"}], "]"}], "\[Equal]", 
                 "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"locCoeffs", "[", 
                   RowBox[{"[", 
                    RowBox[{"locCurrentRow", ",", "locI"}], "]"}], "]"}], "=",
                   "1"}], ";", 
                 RowBox[{"(*", 
                  RowBox[{
                  "\:0423\:0441\:0442\:0430\:043d\:043e\:0432\:0438\:043b\
\:0438", " ", 
                   "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\
\:043d\:0442", " ", "\:043f\:0440\:0438", " ", "Ui"}], "*)"}], 
                 RowBox[{
                  RowBox[{"locCoeffs", "[", 
                   RowBox[{"[", 
                    RowBox[{"locCurrentRow", ",", 
                    RowBox[{"locRowsCount", "+", "locJ"}]}], "]"}], "]"}], 
                  "=", "1"}], ";", 
                 RowBox[{"(*", 
                  RowBox[{
                  "\:0423\:0441\:0442\:0430\:043d\:043e\:0432\:0438\:043b\
\:0438", " ", 
                   "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\
\:043d\:0442", " ", "\:043f\:0440\:0438", " ", "Vj"}], "*)"}], 
                 RowBox[{
                  RowBox[{"locValues", "[", 
                   RowBox[{"[", "locCurrentRow", "]"}], "]"}], "=", 
                  RowBox[{"inTT", "[", 
                   RowBox[{"[", 
                    RowBox[{"locI", ",", "locJ"}], "]"}], "]"}]}], ";", 
                 RowBox[{"(*", 
                  RowBox[{
                  "\:0417\:0430\:043f\:043e\:043c\:043d\:0438\:043b\:0438", 
                   " ", "\:043e\:0433\:0440\:0430\:043d\:0438\:0447\:0435\
\:043d\:0438\:0435", " ", "\:0432", " ", 
                   "\:043f\:0440\:0430\:0432\:043e\:0439", " ", 
                   "\:0447\:0430\:0441\:0442\:0438"}], "*)"}], 
                 RowBox[{"locCurrentRow", "++"}], ";"}]}], "]"}], ";"}]}], 
            "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0414\:043e\:0431\:0430\:0432\:043b\:044f\:0435\:043c", " ", 
           "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0435", " ", 
           "\:0434\:043b\:044f", " ", 
           "\:043d\:0435\:0434\:043e\:0441\:0442\:0430\:044e\:0449\:0435\:0439\
", " ", "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"m", "+", "n", "-", 
              RowBox[{
              "1", " ", "\:0443\:0441\:043b\:043e\:0432\:0438\:0435"}]}], ",", 
             RowBox[{"m", "+", 
              RowBox[{
              "n", " ", 
               "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0445"}\
]}]}], ")"}], " ", "\:043f\:043e\:043b\:0430\:0433\:0430\:044f", " ", 
           
           "\:043f\:0440\:043e\:0438\:0437\:0432\:043e\:043b\:044c\:043d\:043e\
", " ", "U0"}], "=", "0"}], "*)"}], 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"locJ", "=", "1"}], ",", 
          RowBox[{"locJ", "\[LessEqual]", "locColsCount"}], ",", 
          RowBox[{"locJ", "++"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"locCoeffs", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "locJ"}], "]"}], "]"}], "\[Equal]", "1"}], 
             ",", 
             RowBox[{
              RowBox[{
               RowBox[{"locCoeffs", "[", 
                RowBox[{"[", 
                 RowBox[{"locCurrentRow", ",", "locJ"}], "]"}], "]"}], "=", 
               "1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "\:041d\:0430\:0445\:043e\:0434\:0438\:043c", " ", 
          "\:043f\:043e\:0442\:0435\:043d\:0446\:0438\:0430\:043b\:044b"}], 
         "*)"}], 
        RowBox[{"locPotentials", "=", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{"locCoeffs", ",", "locValues"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0418\:0437\:043d\:0430\:0447\:0430\:043b\:044c\:043d\:043e", " ",
            "\:043e\:0446\:0435\:043d\:043a\:0430", " ", 
           "\:043d\:0443\:043b\:0435\:0432\:0430\:044f"}], ",", 
          RowBox[{"\:0442\:043e", " ", "\:0435\:0441\:0442\:044c", " ", 
           RowBox[{
           "\:043d\:0435\:043f\:043e\:043b\:043e\:0436\:0438\:0442\:0435\:043b\
\:044c\:043d\:0430\:044f", ".", "\:0415\:0441\:043b\:0438"}], " ", 
           "\:043e\:043d\:0430", " ", 
           "\:0442\:0430\:043a\:043e\:0432\:043e\:0439", " ", "\:0438", " ", 
           "\:043e\:0441\:0442\:0430\:043d\:0435\:0442\:0441\:044f"}], ",", 
          RowBox[{
          "\:0442\:043e", " ", "\:0440\:0435\:0448\:0435\:043d\:0438\:0435", 
           " ", "\:043d\:0430\:0439\:0434\:0435\:043d\:043e"}]}], "*)"}], 
        RowBox[{"locMaxEstimate", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "\:0421\:043a\:0430\:043d\:0438\:0440\:0443\:0435\:043c", " ", 
          "\:0432\:0441\:0435", " ", 
          "\:043d\:0435\:0431\:0430\:0437\:0438\:0441\:043d\:044b\:0435", " ",
           "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0435"}], 
         "*)"}], 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"locI", "=", "1"}], ",", 
          RowBox[{"locI", "\[LessEqual]", "locRowsCount"}], ",", 
          RowBox[{"locI", "++"}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"locJ", "=", "1"}], ",", 
             RowBox[{"locJ", "\[LessEqual]", "locColsCount"}], ",", 
             RowBox[{"locJ", "++"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"inBasis", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "locJ"}], "]"}], "]"}], "\[Equal]", 
                 "0"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "\:0412\:044b\:0447\:0438\:0441\:043b\:044f\:0435\:0442\
\:0441\:044f", " ", "\:043e\:0446\:0435\:043d\:043a\:0430", " ", "\:0438", 
                   " ", "\:0441\:0440\:0430\:043d\:0438\:0432\:0430\:0435\
\:0442\:0441\:044f", " ", "\:0441", " ", 
                   RowBox[{
                   "\:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\
\:043d\:043e\:0439", ".", "\:0415\:0441\:043b\:0438"}], " ", 
                   "\:0431\:043e\:043b\:044c\:0448\:0435", " ", 
                   "\:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\
\:043d\:043e\:0439", " ", "\:043e\:0446\:0435\:043d\:043a\:0438"}], ",", 
                  RowBox[{
                  "\:0442\:043e", " ", 
                   "\:0437\:0430\:043f\:043e\:043c\:0438\:043d\:0430\:0435\
\:0442\:0441\:044f", " ", "\:043d\:043e\:0432\:0430\:044f"}]}], "*)"}], 
                RowBox[{
                 RowBox[{"locEstimate", "=", 
                  RowBox[{
                   RowBox[{"locPotentials", "[", 
                    RowBox[{"[", "locI", "]"}], "]"}], "+", 
                   RowBox[{"locPotentials", "[", 
                    RowBox[{"[", 
                    RowBox[{"locRowsCount", "+", "locJ"}], "]"}], "]"}], "-", 
                   RowBox[{"inTT", "[", 
                    RowBox[{"[", 
                    RowBox[{"locI", ",", "locJ"}], "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"locEstimate", ">", "0"}], "&&", 
                    RowBox[{"locEstimate", ">", "locMaxEstimate"}]}], ",", 
                   RowBox[{
                    RowBox[{"locNewBasisVarRow", "=", "locI"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"locNewBasisVarCol", "=", "locJ"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"locMaxEstimate", "=", "locEstimate"}], ";"}]}], 
                  "]"}], ";"}]}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0415\:0441\:043b\:0438", " ", 
           "\:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\:0430\
\:044f", " ", "\:043e\:0446\:0435\:043d\:043a\:0430", " ", 
           "\:0442\:0430\:043a", " ", "\:0438", " ", 
           "\:043e\:0441\:0442\:0430\:043b\:0430\:0441\:044c", " ", 
           "\:0440\:0430\:0432\:043d\:043e\:0439", " ", 
           "\:043d\:0443\:043b\:044e"}], ",", 
          RowBox[{
          "\:0442\:043e", " ", 
           "\:043e\:043f\:0442\:0438\:043c\:0430\:043b\:044c\:043d\:043e\:0435\
", " ", "\:0440\:0435\:0448\:0435\:043d\:0438\:0435", " ", 
           "\:0443\:0436\:0435", " ", 
           "\:043d\:0430\:0439\:0434\:0435\:043d\:043e"}], ",", 
          RowBox[{
           RowBox[{
           "\:0432\:0432\:043e\:0434\:0438\:0442\:044c", " ", "\:0432", " ", 
            "\:0431\:0430\:0437\:0438\:0441", " ", 
            "\:0431\:043e\:043b\:044c\:0448\:0435", " ", 
            RowBox[{
            "\:043d\:0435\:0447\:0435\:0433\:043e", ".", 
             "\:0418\:043d\:0430\:0447\:0435"}]}], "-", 
           RowBox[{
           "\:043d\:0430\:0439\:0434\:0435\:043d\:0430", " ", 
            "\:043d\:043e\:0432\:0430\:044f", " ", 
            "\:0431\:0430\:0437\:0438\:0441\:043d\:0430\:044f", " ", 
            "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0430\:044f"}]}]\
}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"locMaxEstimate", "\[Equal]", "0"}], ",", 
          RowBox[{"locResult", "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"locResult", "=", 
            RowBox[{"{", 
             RowBox[{"locNewBasisVarRow", ",", "locNewBasisVarCol"}], "}"}]}],
            ";"}]}], "]"}], ";", "\[IndentingNewLine]", "locResult"}]}], 
      "]"}]}], ";"}],
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "\:0420\:0435\:043a\:0443\:0440\:0441\:0438\:0432\:043d\:0430\:044f", " ",
      "\:043f\:0440\:043e\:0446\:0435\:0434\:0443\:0440\:0430", " ", 
     "\:043d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:044f", " ", 
     "\:0437\:0430\:043c\:043a\:043d\:0443\:0442\:043e\:0433\:043e", " ", 
     "\:0446\:0438\:043a\:043b\:0430"}], "*)"}],
   FontSize->16]}], "\n", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"fnFindCycle", "[", 
      RowBox[{
      "inBasis_", ",", "inStartRow_", ",", "inStartCol_", ",", 
       "inCurrentNodeRow_", ",", "inCurrentNodeCol_", ",", 
       "inBlockDirection_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locRowsCount", ",", "locColsCount", ",", "locResult", ",", "locI", 
         ",", "locFlatList"}], "}"}], ",", 
       RowBox[{
        RowBox[{"locRowsCount", "=", 
         RowBox[{"Length", "[", "inBasis", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locColsCount", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"inBasis", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0415\:0441\:043b\:0438", " ", 
           "\:0434\:043e\:0441\:0442\:0438\:0433\:043b\:0438", " ", 
           "\:043d\:0430\:0447\:0430\:043b\:044c\:043d\:043e\:0439", " ", 
           "\:0442\:043e\:0447\:043a\:0438"}], "-", 
          RowBox[{
          "\:043d\:0430\:0447\:0430\:0442\:044c", " ", 
           "\:0432\:043e\:0437\:0432\:0440\:0430\:0449\:0435\:043d\:0438\:0435\
"}]}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"inStartRow", "\[Equal]", "inCurrentNodeRow"}], "&&", 
           RowBox[{"inStartCol", "\[Equal]", "inCurrentNodeCol"}], "&&", 
           RowBox[{"inBlockDirection", "\[NotEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:041e\:0441\:0443\:0449\:0435\:0441\:0442\:0432\:0438\:0442\:044c\
", " ", "\:043f\:043e\:0438\:0441\:043a", " ", 
           "\:0432\:043f\:0440\:0430\:0432\:043e"}], ",", 
          RowBox[{
          "\:0435\:0441\:043b\:0438", " ", 
           "\:043d\:0430\:043f\:0440\:0430\:0432\:043b\:0435\:043d\:0438\:0435\
", " ", "\:043d\:0435", " ", 
           "\:0437\:0430\:043f\:0440\:0435\:0449\:0435\:043d\:043e", " ", 
           RowBox[{"(", 
            RowBox[{
            "\:0435\:0441\:043b\:0438", " ", "\:043c\:044b", " ", 
             "\:0442\:043e\:043b\:044c\:043a\:043e", " ", 
             "\:0447\:0442\:043e", " ", "\:043d\:0435", " ", 
             "\:043f\:0440\:0438\:0448\:043b\:0438", " ", 
             "\:043e\:0442\:0442\:0443\:0434\:0430"}], ")"}]}]}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inBlockDirection", "\[NotEqual]", "1"}], ",", 
          RowBox[{"(*", 
           RowBox[{
           "\:041f\:0440\:043e\:0441\:043c\:0430\:0442\:0440\:0438\:0432\:0430\
\:0435\:043c", " ", "\:0432\:0441\:0435", " ", "\:0443\:0437\:043b\:044b", 
            " ", "\:0432", " ", "\:0434\:0430\:043d\:043d\:043e\:043c", " ", 
            "\:043d\:0430\:043f\:0440\:0430\:0432\:043b\:0435\:043d\:0438\
\:0438"}], "*)"}], 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"locI", "=", 
              RowBox[{"inCurrentNodeCol", "+", "1"}]}], ",", 
             RowBox[{"locI", "\[LessEqual]", "locColsCount"}], ",", 
             RowBox[{"locI", "++"}], ",", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "\:0415\:0441\:043b\:0438", " ", 
                "\:0431\:0430\:0437\:0438\:0441\:043d\:0430\:044f", " ", 
                "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0430\:044f\
", " ", "\:043d\:0430\:0439\:0434\:0435\:043d\:0430"}], ",", "\:0442\:043e"}],
               "*)"}], 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"inBasis", "[", 
                  RowBox[{"[", 
                   RowBox[{"inCurrentNodeRow", ",", "locI"}], "]"}], "]"}], 
                 "\[Equal]", "1"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                 "\:041f\:044b\:0442\:0430\:0442\:044c\:0441\:044f", " ", 
                  "\:043d\:0430\:0439\:0442\:0438", " ", 
                  "\:043f\:0443\:0442\:044c", " ", "\:0432", " ", 
                  "\:044d\:0442\:043e\:043c", " ", 
                  "\:043d\:0430\:043f\:0440\:0430\:0432\:043b\:0435\:043d\
\:0438\:0438"}], "*)"}], 
                RowBox[{
                 RowBox[{"locResult", "=", 
                  RowBox[{"fnFindCycle", "[", 
                   RowBox[{
                   "inBasis", ",", "inStartRow", ",", "inStartCol", ",", 
                    "inCurrentNodeRow", ",", "locI", ",", "3"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"locFlatList", "=", 
                  RowBox[{"Flatten", "[", "locResult", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{
                   "\:0415\:0441\:043b\:0438", " ", "\:0431\:044b\:043b", " ",
                     "\:0432\:043e\:0437\:0432\:0440\:0430\:0449\:0451\:043d",
                     " ", "\:0440\:0435\:0437\:0443\:043b\:044c\:0442\:0430\
\:0442", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{
                   "\:0437\:043d\:0430\:0447\:0438\:0442", " ", 
                    "\:0446\:0438\:043a\:043b", " ", 
                    "\:0437\:0430\:043c\:043a\:043d\:0443\:043b\:0441\:044f"}]\
, ",", 
                   RowBox[{
                   "\:0438", " ", "\:043c\:043e\:0436\:043d\:043e", " ", 
                    "\:043d\:0430\:0447\:0438\:043d\:0430\:0442\:044c", " ", 
                    "\:0444\:043e\:0440\:043c\:0438\:0440\:043e\:0432\:0430\
\:043d\:0438\:0435", " ", "\:0441\:043f\:0438\:0441\:043a\:0430", " ", 
                    "\:0432\:0435\:0440\:0448\:0438\:043d"}]}], "*)"}], 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"locFlatList", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{
                   "\:0415\:0441\:043b\:0438", " ", "\:0431\:044b\:043b", " ",
                     "\:0432\:043e\:0437\:0432\:0440\:0430\:0449\:0451\:043d",
                     " ", "\:0440\:0435\:0437\:0443\:043b\:044c\:0442\:0430\
\:0442", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], ",", 
                   RowBox[{
                   "\:0442\:043e", " ", "\:0432", " ", 
                    "\:044d\:0442\:043e\:043c", " ", 
                    "\:043d\:0430\:043f\:0440\:0430\:0432\:043b\:0435\:043d\
\:0438\:0438", " ", "\:043f\:0443\:0442\:0438", " ", "\:043d\:0435\:0442"}], 
                   ",", 
                   RowBox[{"\:0438\:043d\:0430\:0447\:0435", "-", 
                    RowBox[{
                    "\:0434\:043e\:0431\:0430\:0432\:0438\:0442\:044c", " ", 
                    "\:043e\:0447\:0435\:0440\:0435\:0434\:043d\:043e\:0439", 
                    " ", "\:0443\:0437\:0435\:043b", " ", "\:0432", " ", 
                    "\:0446\:0438\:043a\:043b"}]}]}], "*)"}], 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"locFlatList", "\[NotEqual]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "&&", 
                    RowBox[{"inBlockDirection", "\[NotEqual]", "3"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"locResult", ",", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}]}], "]"}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], 
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "\:041e\:0441\:0443\:0449\:0435\:0441\:0442\:0432\:0438\:0442\:044c",
           " ", "\:043f\:043e\:0438\:0441\:043a", " ", 
          "\:0432\:043d\:0438\:0437"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inBlockDirection", "\[NotEqual]", "2"}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"locI", "=", 
              RowBox[{"inCurrentNodeRow", "+", "1"}]}], ",", 
             RowBox[{"locI", "\[LessEqual]", "locRowsCount"}], ",", 
             RowBox[{"locI", "++"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"inBasis", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "inCurrentNodeCol"}], "]"}], "]"}], 
                 "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"locResult", "=", 
                  RowBox[{"fnFindCycle", "[", 
                   RowBox[{
                   "inBasis", ",", "inStartRow", ",", "inStartCol", ",", 
                    "locI", ",", "inCurrentNodeCol", ",", "4"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"locFlatList", "=", 
                  RowBox[{"Flatten", "[", "locResult", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"locFlatList", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"locFlatList", "\[NotEqual]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "&&", 
                    RowBox[{"inBlockDirection", "\[NotEqual]", "4"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"locResult", ",", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}]}], "]"}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], 
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "\:041e\:0441\:0443\:0449\:0435\:0441\:0442\:0432\:0438\:0442\:044c",
           " ", "\:043f\:043e\:0438\:0441\:043a", " ", 
          "\:0432\:043b\:0435\:0432\:043e"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inBlockDirection", "\[NotEqual]", "3"}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"locI", "=", 
              RowBox[{"inCurrentNodeCol", "-", "1"}]}], ",", 
             RowBox[{"locI", "\[GreaterEqual]", "1"}], ",", 
             RowBox[{"locI", "--"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"inBasis", "[", 
                  RowBox[{"[", 
                   RowBox[{"inCurrentNodeRow", ",", "locI"}], "]"}], "]"}], 
                 "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"locResult", "=", 
                  RowBox[{"fnFindCycle", "[", 
                   RowBox[{
                   "inBasis", ",", "inStartRow", ",", "inStartCol", ",", 
                    "inCurrentNodeRow", ",", "locI", ",", "1"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"locFlatList", "=", 
                  RowBox[{"Flatten", "[", "locResult", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"locFlatList", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"locFlatList", "\[NotEqual]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "&&", 
                    RowBox[{"inBlockDirection", "\[NotEqual]", "1"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"locResult", ",", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}]}], "]"}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], 
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "\:041e\:0441\:0443\:0449\:0435\:0441\:0442\:0432\:0438\:0442\:044c",
           " ", "\:043f\:043e\:0438\:0441\:043a", " ", 
          "\:0432\:0432\:0435\:0440\:0445"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inBlockDirection", "\[NotEqual]", "4"}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"locI", "=", 
              RowBox[{"inCurrentNodeRow", "-", "1"}]}], ",", 
             RowBox[{"locI", "\[GreaterEqual]", "1"}], ",", 
             RowBox[{"locI", "--"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"inBasis", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "inCurrentNodeCol"}], "]"}], "]"}], 
                 "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"locResult", "=", 
                  RowBox[{"fnFindCycle", "[", 
                   RowBox[{
                   "inBasis", ",", "inStartRow", ",", "inStartCol", ",", 
                    "locI", ",", "inCurrentNodeCol", ",", "2"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"locFlatList", "=", 
                  RowBox[{"Flatten", "[", "locResult", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"locFlatList", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"locFlatList", "\[NotEqual]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "&&", 
                    RowBox[{"inBlockDirection", "\[NotEqual]", "2"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"locResult", ",", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}]}], "]"}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], 
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}]}], "]"}]}], ";"}],
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "\:041d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:0435", " ", 
      "\:0432\:044b\:0432\:043e\:0434\:0438\:043c\:043e\:0439", " ", 
      "\:0438\:0437", " ", "\:0431\:0430\:0437\:0438\:0441\:0430", " ", 
      "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ", 
      "\:0430\:043d\:0430\:043b\:0438\:0437\:0438\:0440\:0443\:044f", " ", 
      "\:0446\:0438\:043a\:043b"}], ",", 
     RowBox[{
     "\:0441\:043e\:0434\:0435\:0440\:0436\:0430\:0449\:0438\:0439", " ", 
      "\:0432\:0432\:043e\:0434\:0438\:043c\:0443\:044e", " ", 
      "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0443\:044e", " ", 
      "\:0438", " ", "\:0442\:0435\:043a\:0443\:0449\:0438\:0439", " ", 
      "\:0431\:0430\:0437\:0438\:0441"}]}], "*)"}],
   FontSize->16]}], "\n", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"fnRemoveBasisVar", "[", 
      RowBox[{"inCycle_", ",", "inBasis_", ",", "inValues_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locMinBasisVarValue", ",", "locVarToRemoveRow", ",", 
         "locVarToRemoveCol", ",", "locBasis", ",", "locValues", ",", "locI", 
         ",", "locCycleLength"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{
        "\:0418\:0437\:043d\:0430\:0447\:0430\:043b\:044c\:043d\:043e", ",", 
         RowBox[{
         "\:0432\:044b\:0432\:043e\:0434\:0438\:043c\:043e\:0439", " ", 
          "\:0438\:0437", " ", "\:0431\:0430\:0437\:0438\:0441\:0430", " ", 
          "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ",
           "\:0441\:0447\:0438\:0442\:0430\:0435\:043c", " ", 
          "\:043f\:0435\:0440\:0432\:0443\:044e", " ", 
          "\:0432\:0435\:0440\:0448\:0438\:043d\:0443"}], ",", 
         RowBox[{
         "\:0432", " ", "\:043a\:043e\:0442\:043e\:0440\:043e\:0439", " ", 
          "\:043f\:0440\:043e\:0438\:0441\:0445\:043e\:0434\:0438\:0442", " ",
           "\:0443\:043c\:0435\:043d\:044c\:0448\:0435\:043d\:0438\:0435", 
          " ", "\:0437\:043d\:0430\:0447\:0435\:043d\:0438\:044f", " ", 
          "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439"}]}], 
        "*)"}], 
       RowBox[{
        RowBox[{"locMinBasisVarValue", "=", 
         RowBox[{"inValues", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"inCycle", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"inCycle", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locVarToRemoveRow", "=", 
         RowBox[{"inCycle", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locVarToRemoveCol", "=", 
         RowBox[{"inCycle", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locBasis", "=", "inBasis"}], ";", "\[IndentingNewLine]", 
        RowBox[{"locValues", "=", "inValues"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "\:041f\:0440\:043e\:0441\:043a\:0430\:043d\:0438\:0440\:043e\:0432\
\:0430\:043b\:0438", " ", "\:0432\:0441\:0435", " ", 
          "\:0443\:043c\:0435\:043d\:044c\:0448\:0430\:0435\:043c\:044b\:0435\
", " ", "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0435", " ", 
          "\:0432", " ", "\:043f\:043e\:0438\:0441\:043a\:0430\:0445", " ", 
          
          "\:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\:043e\:0439\
"}], "*)"}], 
        RowBox[{"locI", "=", "3"}], ";", "\[IndentingNewLine]", 
        RowBox[{"locCycleLength", "=", 
         RowBox[{"Length", "[", "inCycle", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"locI", "\[LessEqual]", "locCycleLength"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"inValues", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
              "<", "locMinBasisVarValue"}], ",", 
             RowBox[{
              RowBox[{"locMinBasisVarValue", "=", 
               RowBox[{"inValues", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"inCycle", "[", 
                   RowBox[{"[", 
                    RowBox[{"locI", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"inCycle", "[", 
                   RowBox[{"[", 
                    RowBox[{"locI", ",", "2"}], "]"}], "]"}]}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"locVarToRemoveRow", "=", 
               RowBox[{"inCycle", "[", 
                RowBox[{"[", 
                 RowBox[{"locI", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"locVarToRemoveCol", "=", 
               RowBox[{"inCycle", "[", 
                RowBox[{"[", 
                 RowBox[{"locI", ",", "2"}], "]"}], "]"}]}], ";"}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"locI", "+=", "2"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0421\:043a\:043e\:0440\:0440\:0435\:043a\:0442\:0438\:0440\:043e\
\:0432\:0430\:043b\:0438", " ", 
           "\:0437\:043d\:0430\:0447\:0435\:043d\:0438\:044f", " ", 
           "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0445"}], 
          ",", 
          RowBox[{
          "\:0447\:0435\:0440\:0435\:0437", " ", "\:043e\:0434\:043d\:0443", 
           " ", "\:0443\:043c\:0435\:043d\:044c\:0448\:0430\:0435\:043c"}], 
          ",", 
          RowBox[{
          "\:0447\:0435\:0440\:0435\:0437", " ", "\:043e\:0434\:043d\:0443", 
           " ", "\:0443\:0432\:0435\:043b\:0438\:0447\:0438\:0432\:0430\:0435\
\:043c"}]}], "*)"}], 
        RowBox[{"locI", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"locI", "\[LessEqual]", "locCycleLength"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Floor", "[", 
               RowBox[{"locI", "/", "2."}], "]"}], "\[Equal]", 
              RowBox[{"locI", "/", "2."}]}], ",", 
             RowBox[{
              RowBox[{"locValues", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], "+=",
               "locMinBasisVarValue"}], ",", 
             RowBox[{
              RowBox[{"locValues", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], "-=",
               "locMinBasisVarValue"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"locI", "++"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "\:0412\:044b\:0432\:043e\:0434\:0438\:043c", " ", "\:0438\:0437", 
          " ", "\:0431\:0430\:0437\:0438\:0441\:0430", " ", 
          "\:0441\:0442\:0430\:0440\:0443\:044e", " ", 
          "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0443\:044e"}], 
         "*)"}], 
        RowBox[{
         RowBox[{"locBasis", "[", 
          RowBox[{"[", 
           RowBox[{"locVarToRemoveRow", ",", "locVarToRemoveCol"}], "]"}], 
          "]"}], "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"locBasis", ",", "locValues"}], "}"}]}]}], "]"}]}], ";"}],
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "\:041d\:0430\:0439\:0442\:0438", " ", 
     "\:0434\:043e\:043f\:0443\:0441\:0442\:0438\:043c\:043e\:0435", " ", 
     "\:043d\:0430\:0447\:0430\:043b\:044c\:043d\:043e\:0435", " ", 
     "\:0431\:0430\:0437\:0438\:0441\:043d\:043e\:0435", " ", 
     "\:0440\:0435\:0448\:0435\:043d\:0438\:0435"}], "*)"}],
   FontSize->16]}], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"basis", ",", "values"}], "}"}], "=", 
    RowBox[{"fnFindBasisNWCMethod", "[", 
     RowBox[{"TT", ",", "RL", ",", "CL"}], "]"}]}], ";"}],
  FontSize->16], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"newBasisVarRow", "=", 
    RowBox[{"-", "1"}]}], ";"}],
  FontSize->16], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"newBasisVarCol", "=", 
    RowBox[{"-", "1"}]}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"iterations", " ", "=", " ", "0"}], ";"}],
   FontSize->16], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{"True", ",", 
      RowBox[{"(*", 
       RowBox[{
       "\:041d\:0430\:0439\:0442\:0438", " ", 
        "\:043d\:043e\:0432\:0443\:044e", " ", 
        "\:0431\:0430\:0437\:0438\:0441\:043d\:0443\:044e", " ", 
        "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0443\:044e"}], 
       "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newBasisVarRow", ",", "newBasisVarCol"}], "}"}], "=", 
        RowBox[{"fnFindNextBasisVar", "[", 
         RowBox[{"TT", ",", "basis"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"newBasisVarRow", ",", "newBasisVarCol"}], "}"}], 
          "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"basis", "[", 
         RowBox[{"[", 
          RowBox[{"newBasisVarRow", ",", "newBasisVarCol"}], "]"}], "]"}], 
        "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "\:041d\:0430\:0439\:0442\:0438", " ", "\:0446\:0438\:043a\:043b"}], 
        "*)"}], 
       RowBox[{"cycle", "=", 
        RowBox[{"fnFindCycle", "[", 
         RowBox[{
         "basis", ",", "newBasisVarRow", ",", "newBasisVarCol", ",", 
          "newBasisVarRow", ",", "newBasisVarCol", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "\:0423\:0434\:0430\:043b\:0438\:0442\:044c", " ", 
         "\:043b\:0438\:0448\:043d\:044e\:044e", " ", 
         "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0443\:044e", " ", 
         "\:0438\:0437", " ", "\:0431\:0430\:0437\:0438\:0441\:0430"}], 
        "*)"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"basis", ",", "values"}], "}"}], "=", 
        RowBox[{"fnRemoveBasisVar", "[", 
         RowBox[{"cycle", ",", "basis", ",", "values"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"iterations", "++"}], ";"}]}], "]"}], ";"}],
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "\:0412\:044b\:0447\:0438\:0441\:043b\:0438\:0442\:044c", " ", 
     "\:043e\:043f\:0442\:0438\:043c\:0430\:043b\:044c\:043d\:043e\:0435", 
     " ", "\:0437\:043d\:0430\:0447\:0435\:043d\:0438\:0435", " ", 
     "\:0444\:0443\:043d\:043a\:0446\:0438\:0438"}], "*)"}],
   FontSize->16]}], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"functionValue", "=", "0"}], ";"}],
  FontSize->16], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "rowsCount"}], ",", 
     RowBox[{"i", "++"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "colsCount"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{
         RowBox[{"functionValue", "+=", 
          RowBox[{
           RowBox[{"TT", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
           RowBox[{"values", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], "]"}], 
      ";"}]}], "]"}], ";"}],
  FontSize->16], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\:0417\:043d\:0430\:0447\:0435\:043d\:0438\:0435 \:0446\:0435\:043b\
\:0435\:0432\:043e\:0439 \:0444\:0443\:043d\:043a\:0446\:0438\:0438 = \>\"", "<>", 
     RowBox[{"ToString", "[", "functionValue", "]"}]}], "]"}], ";"}],
  FontSize->16], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{
   "Print", "[", 
    "\"\<\:0411\:0430\:0437\:0438\:0441 \:043f\:0435\:0440\:0435\:043c\:0435\
\:043d\:043d\:044b\:0445\>\"", "]"}], ";"}],
  FontSize->16], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"MatrixForm", "[", "basis", "]"}], "]"}], ";"}],
  FontSize->16], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{
   "Print", "[", 
    "\"\<\:0417\:043d\:0430\:0447\:0435\:043d\:0438\:044f \:043f\:0435\:0440\
\:0435\:043c\:0435\:043d\:043d\:044b\:0445\>\"", "]"}], ";"}],
  FontSize->16], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"MatrixForm", "[", "values", "]"}], "]"}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\:0427\:0438\:0441\:043b\:043e \:0438\:0442\:0435\:0440\:0430\:0446\
\:0438\:0439: \>\"", " ", "<>", 
    RowBox[{"ToString", "[", "iterations", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.7324059299323435`*^9, {3.7324272972404757`*^9, 3.7324273519536057`*^9}, {
   3.7324273915738716`*^9, 3.732427441406722*^9}, {3.7324316272501383`*^9, 
   3.732431651265512*^9}, {3.732431723945669*^9, 3.732431750797205*^9}, {
   3.7324443672425947`*^9, 3.7324444238738337`*^9}, {3.732444512087879*^9, 
   3.7324445253416367`*^9}, {3.732446790687207*^9, 3.732446803805958*^9}},
 FontFamily->"Consolas",
 FontSize->12,
 FontWeight->"Plain"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "2", "3", "4", "6", "8", "0"},
     {"2", "2", "0", "2", "4", "6", "0"},
     {"4", "4", "2", "0", "2", "2", "0"},
     {"6", "6", "4", "4", "2", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.731657344559179*^9, 3.732373599117483*^9, {3.732431696279087*^9, 
   3.7324317570675635`*^9}, 3.7324445310969663`*^9, 3.732446810432337*^9},
 FontFamily->"Consolas",
 FontSize->12],

Cell[CellGroupData[{

Cell[BoxData["\<\"\:0417\:043d\:0430\:0447\:0435\:043d\:0438\:0435 \:0446\
\:0435\:043b\:0435\:0432\:043e\:0439 \:0444\:0443\:043d\:043a\:0446\:0438\
\:0438 = 560\"\>"], "Print",
 CellChangeTimes->{{3.7324317319451265`*^9, 3.7324317572115717`*^9}, 
   3.732444537525334*^9, 3.7324468105033407`*^9}],

Cell[BoxData["\<\"\:0411\:0430\:0437\:0438\:0441 \:043f\:0435\:0440\:0435\
\:043c\:0435\:043d\:043d\:044b\:0445\"\>"], "Print",
 CellChangeTimes->{{3.7324317319451265`*^9, 3.7324317572115717`*^9}, 
   3.732444537525334*^9, 3.7324468105053406`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "0", "0", "0", "0", "1"},
     {"0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "1", "1", "1", "1"},
     {"0", "0", "0", "0", "0", "1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.7324317319451265`*^9, 3.7324317572115717`*^9}, 
   3.732444537525334*^9, 3.7324468105093412`*^9}],

Cell[BoxData["\<\"\:0417\:043d\:0430\:0447\:0435\:043d\:0438\:044f \:043f\
\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0445\"\>"], "Print",
 CellChangeTimes->{{3.7324317319451265`*^9, 3.7324317572115717`*^9}, 
   3.732444537525334*^9, 3.7324468105123415`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"56", "56", "0", "0", "0", "0", "16"},
     {"0", "0", "128", "0", "0", "0", "0"},
     {"0", "0", "128", "64", "32", "64", "224"},
     {"0", "0", "0", "0", "0", "64", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.7324317319451265`*^9, 3.7324317572115717`*^9}, 
   3.732444537525334*^9, 3.7324468105143414`*^9}],

Cell[BoxData["\<\"\:0427\:0438\:0441\:043b\:043e \:0438\:0442\:0435\:0440\
\:0430\:0446\:0438\:0439: 2\"\>"], "Print",
 CellChangeTimes->{{3.7324317319451265`*^9, 3.7324317572115717`*^9}, 
   3.732444537525334*^9, 3.7324468105173416`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 59153, 1467, 4279, "Input"],
Cell[59736, 1491, 924, 24, 86, "Output"],
Cell[CellGroupData[{
Cell[60685, 1519, 298, 4, 22, "Print"],
Cell[60986, 1525, 247, 3, 22, "Print"],
Cell[61236, 1530, 838, 21, 65, "Print"],
Cell[62077, 1553, 265, 3, 22, "Print"],
Cell[62345, 1558, 851, 21, 65, "Print"],
Cell[63199, 1581, 238, 3, 22, "Print"]
}, Open  ]]
}, Open  ]]
}
]
*)

