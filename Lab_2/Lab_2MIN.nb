(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     78235,       1743]
NotebookOptionsPosition[     77632,       1719]
NotebookOutlinePosition[     77980,       1734]
CellTagsIndexPosition[     77937,       1731]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TT", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "2", ",", "3", ",", "4", ",", "6", ",", "8", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "2", ",", "2", ",", "0", ",", "2", ",", "4", ",", "6", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "4", ",", "4", ",", "2", ",", "0", ",", "2", ",", "2", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "6", ",", "6", ",", "4", ",", "4", ",", "2", ",", "0", ",", "0"}], 
        "}"}]}], "}"}]}], ";"}], "\n", "                     ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CL", "=", 
     RowBox[{"{", 
      RowBox[{
      "56", ",", "56", ",", "256", ",", "64", ",", "32", ",", "128", ",", 
       "240"}], "}"}]}], ";"}], "\[IndentingNewLine]", "                    ",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RL", "=", 
     RowBox[{"{", 
      RowBox[{"128", ",", "128", ",", "512", ",", "64"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rowsCount", "=", 
     RowBox[{"Length", "[", "RL", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"colsCount", "=", 
     RowBox[{"Length", "[", "CL", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "basis", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "values", "]"}], ";"}], "\n", "\[IndentingNewLine]",
    "                                                                      ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fnFindBasisMinPriceMethod", "[", 
      RowBox[{"inTT_", ",", "inRL_", ",", "inCL_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"locRL", "=", "inRL"}], ",", 
         RowBox[{"locCL", "=", "inCL"}], ",", "locCurrentRow", ",", 
         "locCurrentCol", ",", "locVarBasis", ",", "locVarValues", ",", 
         "locRowsCount", ",", "locColsCount", ",", 
         RowBox[{"locVarsChosen", "=", "0"}], ",", "locVarsToChoose", ",", 
         "rowsUse", ",", "colsUse"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"locRowsCount", "=", 
         RowBox[{"Length", "[", "locRL", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"locColsCount", "=", 
         RowBox[{"Length", "[", "locCL", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"locVarBasis", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "locColsCount", "}"}]}], "]"}], ",", 
           RowBox[{"{", "locRowsCount", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locVarValues", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "locColsCount", "}"}]}], "]"}], ",", 
           RowBox[{"{", "locRowsCount", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locVarsToChoose", "=", 
         RowBox[{"locRowsCount", "+", "locColsCount", "-", "1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rowsUse", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", "locRowsCount"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"colsUse", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", "locColsCount"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "                                                              ", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"locVarsChosen", "<", "locVarsToChoose"}], ",", 
          "\[IndentingNewLine]", 
          "                                                               ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"min", "=", 
            RowBox[{"Max", "[", "inTT", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"find", " ", "min"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", "locRowsCount"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             "                                                               \
", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"rowsUse", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                 RowBox[{
                  RowBox[{"Max", "[", "locRL", "]"}], "\[NotEqual]", " ", 
                  "0"}]}], ",", 
                RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "1"}], ",", 
                RowBox[{"j", "\[LessEqual]", "locColsCount"}], ",", 
                RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                "                                                             \
  ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"colsUse", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    " ", 
                    RowBox[{
                    RowBox[{"Max", "[", "locCL", "]"}], "\[NotEqual]", 
                    "0"}]}], ")"}], "||", 
                    RowBox[{
                    RowBox[{"locVarBasis", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", 
                    "1"}]}], ",", 
                   RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"min", ">=", 
                    RowBox[{"TT", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"min", "=", 
                    RowBox[{"TT", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"locCurrentRow", "=", "i"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"locCurrentCol", "=", "j"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}]}]}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"locVarBasis", "[", 
             RowBox[{"[", 
              RowBox[{"locCurrentRow", ",", "locCurrentCol"}], "]"}], "]"}], 
            "=", "1"}], ";", "\[IndentingNewLine]", 
           "                                                               ", 
           RowBox[{"(*", 
            RowBox[{"right", " ", "\[GreaterEqual]", " ", "down"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"locRL", "[", 
               RowBox[{"[", "locCurrentRow", "]"}], "]"}], "\[GreaterEqual]", 
              " ", 
              RowBox[{"locCL", "[", 
               RowBox[{"[", "locCurrentCol", "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"locVarValues", "[", 
                RowBox[{"[", 
                 RowBox[{"locCurrentRow", ",", "locCurrentCol"}], "]"}], 
                "]"}], "=", 
               RowBox[{"locCL", "[", 
                RowBox[{"[", "locCurrentCol", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"locRL", "[", 
                RowBox[{"[", "locCurrentRow", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"locRL", "[", 
                 RowBox[{"[", "locCurrentRow", "]"}], "]"}], "-", 
                RowBox[{"locCL", "[", 
                 RowBox[{"[", "locCurrentCol", "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"locCL", "[", 
                  RowBox[{"[", "locCurrentCol", "]"}], "]"}], "\[Equal]", 
                 "0"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"rowsUse", "[", 
                  RowBox[{"[", "locCurrentRow", "]"}], "]"}], "=", "1"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"locCL", "[", 
                   RowBox[{"[", "locCurrentCol", "]"}], "]"}], "=", "0"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"colsUse", "[", 
                   RowBox[{"[", "locCurrentCol", "]"}], "]"}], "=", "1"}]}]}],
                "]"}], ";"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"right", " ", "<", " ", "down"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"locVarValues", "[", 
                RowBox[{"[", 
                 RowBox[{"locCurrentRow", ",", "locCurrentCol"}], "]"}], 
                "]"}], "=", 
               RowBox[{"locRL", "[", 
                RowBox[{"[", "locCurrentRow", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"locCL", "[", 
                RowBox[{"[", "locCurrentCol", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"locCL", "[", 
                 RowBox[{"[", "locCurrentCol", "]"}], "]"}], "-", 
                RowBox[{"locRL", "[", 
                 RowBox[{"[", "locCurrentRow", "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"locRL", "[", 
                  RowBox[{"[", "locCurrentRow", "]"}], "]"}], "\[Equal]", 
                 "0"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"colsUse", "[", 
                  RowBox[{"[", "locCurrentCol", "]"}], "]"}], "=", "1"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"locRL", "[", 
                   RowBox[{"[", "locCurrentRow", "]"}], "]"}], "=", "0"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"rowsUse", "[", 
                   RowBox[{"[", "locCurrentRow", "]"}], "]"}], "=", "1"}]}]}],
                "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"locVarsChosen", "++"}]}]}], "\[IndentingNewLine]", "]"}], 
        "    ", ";", 
        "                                                           ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"locVarBasis", ",", "locVarValues"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   "                                                                       ", 
   RowBox[{"(*", 
    RowBox[{
    "\:041d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:0435", " ", 
     "\:0441\:043b\:0435\:0434\:0443\:044e\:0449\:0435\:0439", " ", 
     "\:0432\:043a\:043b\:044e\:0447\:0430\:0435\:043c\:043e\:0439", " ", 
     "\:0432", " ", "\:0431\:0430\:0437\:0438\:0441", " ", 
     "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ", 
     "\:043c\:0435\:0442\:043e\:0434\:043e\:043c", " ", 
     "\:043f\:043e\:0442\:0435\:043d\:0446\:0438\:0430\:043b\:043e\:0432"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"fnFindNextBasisVar", "[", 
      RowBox[{"inTT_", ",", "inBasis_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locRowsCount", ",", "locColsCount", ",", "locCoeffs", ",", 
         "locValues", ",", "locI", ",", "locJ", ",", "locCurrentRow", ",", 
         "locPotentials", ",", "locMaxEstimate", ",", "locNewBasisVarRow", 
         ",", "locNewBasisVarCol", ",", "locEstimate", ",", "locResult"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"locRowsCount", "=", 
         RowBox[{"Length", "[", "inTT", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"locColsCount", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"inTT", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
         "\:0422\:0430\:0431\:043b\:0438\:0446\:0430", " ", 
          "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\:043d\:0442\
\:043e\:0432", " ", "\:0434\:043b\:044f", " ", 
          "\:0441\:0438\:0441\:0442\:0435\:043c\:044b", " ", 
          "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439", " ", 
          "\:043f\:043e", " ", 
          "\:043d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:044e", " ",
           "\:043f\:043e\:0442\:0435\:043d\:0446\:0438\:0430\:043b\:043e\:0432\
"}], "*)"}], 
        RowBox[{"locCoeffs", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"locRowsCount", "+", "locColsCount"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"locRowsCount", "+", "locColsCount"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
         "\:0417\:043d\:0430\:0447\:0435\:043d\:0438\:044f", " ", 
          "\:043f\:0440\:0430\:0432\:043e\:0439", " ", 
          "\:0447\:0430\:0441\:0442\:0438", " ", 
          "\:0441\:0438\:0441\:0442\:0435\:043c\:044b", " ", 
          "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locValues", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"locRowsCount", "+", "locColsCount"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"locCurrentRow", "=", "1"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0418\:0437\:0443\:0447\:0430\:0435\:043c", " ", "\:0432", " ", 
           "\:0446\:0438\:043a\:043b\:0435", " ", "\:0432\:0441\:0435", " ", 
           "\:0431\:0430\:0437\:0438\:0441\:043d\:044b\:0435", " ", 
           "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0435"}], 
          ",", 
          RowBox[{
          "\:0444\:043e\:0440\:043c\:0438\:0440\:0443\:0435\:043c", " ", 
           "\:043c\:0430\:0442\:0440\:0438\:0446\:0443", " ", 
           "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\:043d\:0442\
\:043e\:0432", " ", "\:0434\:043b\:044f", " ", 
           "\:0440\:0435\:0448\:0435\:043d\:0438\:044f", " ", 
           "\:0441\:0438\:0441\:0442\:0435\:043c\:044b", " ", 
           "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439", " ", 
           "\:0434\:043b\:044f", " ", 
           "\:043d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:044f", 
           " ", "\:043f\:043e\:0442\:0435\:043d\:0446\:0438\:0430\:043b\:043e\
\:0432"}]}], "*)"}], "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "\:043e\:043f\:0440\:0435\:0434\:0435\:043b\:044f\:0435\:043c", 
            " ", "\:043f\:043e", " ", "\:043d\:043e\:043c\:0435\:0440\:0443", 
            " ", "\:0431\:0430\:0437\:0438\:0441\:043d\:043e\:0439", " ", 
            RowBox[{
            "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", 
             ":", " ", "\[IndentingNewLine]", 
             RowBox[{
             "\:043d\:043e\:043c\:0435\:0440", " ", 
              "\:0441\:0442\:0440\:043e\:043a\:0438"}]}]}], " ", "->", " ", 
           RowBox[{
           "1", " ", "\:0432", " ", 
            "\:043a\:043b\:0435\:0442\:043e\:0447\:043a\:0443", " ", 
            "\:0441\:043e\:043e\:0442\:0432", " ", 
            "\:0441\:0442\:043e\:043b\:0431\:0446\:0430", 
            RowBox[{"(", 
             RowBox[{
             "\:043e\:0442", " ", "1", " ", "\:0434\:043e", " ", "4"}], 
             ")"}]}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "\:043d\:043e\:043c\:0435\:0440", " ", 
            "\:0441\:0442\:043e\:043b\:0431\:0446\:0430"}], " ", "\[Rule]", 
           " ", 
           RowBox[{
            RowBox[{
            "1", " ", "\:0432", " ", 
             "\:043a\:043b\:0435\:0442\:043e\:0447\:043a\:0443", " ", 
             "\:0441\:043e\:043e\:0442\:0432", " ", 
             "\:0441\:0442\:043e\:0431\:0446\:0430"}], " ", "+", " ", 
            RowBox[{"6", " ", 
             RowBox[{"(", 
              RowBox[{
              "\:043e\:0442", " ", "5", " ", "\:0434\:043e", " ", "10"}], 
              ")"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"locI", "=", "1"}], ",", 
          RowBox[{"locI", "\[LessEqual]", "locRowsCount"}], ",", 
          RowBox[{"locI", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"locJ", "=", "1"}], ",", 
            RowBox[{"locJ", "\[LessEqual]", "locColsCount"}], ",", 
            RowBox[{"locJ", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"inBasis", "[", 
                RowBox[{"[", 
                 RowBox[{"locI", ",", "locJ"}], "]"}], "]"}], "\[Equal]", 
               "1"}], ",", "\[IndentingNewLine]", 
              "                                                               \
       ", 
              RowBox[{"(*", 
               RowBox[{
               "\:0423\:0441\:0442\:0430\:043d\:043e\:0432\:0438\:043b\:0438",
                 " ", "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\
\:043d\:0442", " ", "\:043f\:0440\:0438", " ", "Ui", " ", 
                RowBox[{"(", 
                 RowBox[{
                 "\:043f\:0440\:0438", " ", 
                  "\:043f\:0440\:0435\:0434\:043b\:043e\:0436\:0435\:043d\
\:0438\:0438"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"locCoeffs", "[", 
                 RowBox[{"[", 
                  RowBox[{"locCurrentRow", ",", "locI"}], "]"}], "]"}], "=", 
                "1"}], ";", "\[IndentingNewLine]", 
               "                                                              \
       ", 
               RowBox[{"(*", 
                RowBox[{
                "\:0423\:0441\:0442\:0430\:043d\:043e\:0432\:0438\:043b\:0438\
", " ", "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\:043d\:0442", 
                 " ", "\:043f\:0440\:0438", " ", "Vj", " ", 
                 RowBox[{"(", 
                  RowBox[{
                  "\:043f\:0440\:0438", " ", 
                   "\:0441\:043f\:0440\:043e\:0441\:0435"}], ")"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"locCoeffs", "[", 
                 RowBox[{"[", 
                  RowBox[{"locCurrentRow", ",", 
                   RowBox[{"locRowsCount", "+", "locJ"}]}], "]"}], "]"}], "=",
                 "1"}], ";", "\[IndentingNewLine]", 
               "                                                              \
       ", 
               RowBox[{"(*", 
                RowBox[{
                "\:0417\:0430\:043f\:043e\:043c\:043d\:0438\:043b\:0438", " ",
                  "\:043e\:0433\:0440\:0430\:043d\:0438\:0447\:0435\:043d\
\:0438\:0435", " ", "\:0432", " ", "\:043f\:0440\:0430\:0432\:043e\:0439", 
                 " ", "\:0447\:0430\:0441\:0442\:0438"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"locValues", "[", 
                 RowBox[{"[", "locCurrentRow", "]"}], "]"}], "=", 
                RowBox[{"inTT", "[", 
                 RowBox[{"[", 
                  RowBox[{"locI", ",", "locJ"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"locCurrentRow", "++"}]}]}], "]"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        "                                                                  ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0414\:043e\:0431\:0430\:0432\:043b\:044f\:0435\:043c", " ", 
           "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0435", " ", 
           "\:0434\:043b\:044f", " ", 
           "\:043d\:0435\:0434\:043e\:0441\:0442\:0430\:044e\:0449\:0435\:0439\
", " ", "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"m", "+", "n", "-", 
              RowBox[{
              "1", " ", "\:0443\:0441\:043b\:043e\:0432\:0438\:0435"}]}], ",", 
             RowBox[{"m", "+", 
              RowBox[{
              "n", " ", 
               "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0445"}\
]}]}], ")"}], " ", "\:043f\:043e\:043b\:0430\:0433\:0430\:044f", " ", 
           "\:043f\:0440\:043e\:0438\:0437\:0432\:043e\:043b\:044c\:043d\:043e\
", " ", "U0"}], "=", "0"}], "*)"}], 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"locJ", "=", "1"}], ",", 
          RowBox[{"locJ", "\[LessEqual]", "locColsCount"}], ",", 
          RowBox[{"locJ", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"locCoeffs", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "locJ"}], "]"}], "]"}], "\[Equal]", "1"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"locCoeffs", "[", 
               RowBox[{"[", 
                RowBox[{"locCurrentRow", ",", "locJ"}], "]"}], "]"}], "=", 
              "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}]}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
         "\:041d\:0430\:0445\:043e\:0434\:0438\:043c", " ", 
          "\:043f\:043e\:0442\:0435\:043d\:0446\:0438\:0430\:043b\:044b"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"locPotentials", "=", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{"locCoeffs", ",", "locValues"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0418\:0437\:043d\:0430\:0447\:0430\:043b\:044c\:043d\:043e", " ",
            "\:043e\:0446\:0435\:043d\:043a\:0430", " ", 
           "\:043d\:0443\:043b\:0435\:0432\:0430\:044f"}], ",", 
          RowBox[{"\:0442\:043e", " ", "\:0435\:0441\:0442\:044c", " ", 
           RowBox[{
           "\:043d\:0435\:043f\:043e\:043b\:043e\:0436\:0438\:0442\:0435\:043b\
\:044c\:043d\:0430\:044f", ".", "\:0415\:0441\:043b\:0438"}], " ", 
           "\:043e\:043d\:0430", " ", 
           "\:0442\:0430\:043a\:043e\:0432\:043e\:0439", " ", "\:0438", " ", 
           "\:043e\:0441\:0442\:0430\:043d\:0435\:0442\:0441\:044f"}], ",", 
          RowBox[{
          "\:0442\:043e", " ", "\:0440\:0435\:0448\:0435\:043d\:0438\:0435", 
           " ", "\:043d\:0430\:0439\:0434\:0435\:043d\:043e"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
         "\:043d\:0443\:0436\:043d\:043e", " ", 
          "\:043d\:0430\:0439\:0442\:0438", " ", 
          "\:0441\:0430\:043c\:0443\:044e", " ", 
          "\:0431\:043e\:043b\:044c\:0448\:0443\:044e", " ", 
          "\:043f\:043e\:043b\:043e\:0436\:0438\:0442\:0435\:043b\:044c\:043d\
\:0443\:044e", " ", "\:043e\:0446\:0435\:043d\:043a\:0443", " ", 
          RowBox[{"(", 
           RowBox[{
           "\:043e\:0446\:0435\:043d\:043a\:0438", " ", 
            "\:0441\:043e\:0441\:0442\:0430\:0432\:043b\:044f\:044e\:0442\
\:0441\:044f", " ", "\:0434\:043b\:044f", " ", 
            "\:043d\:0435\:0431\:0430\:0437\:0438\:0441\:043d\:044b\:0445", 
            " ", "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0445\
"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"locMaxEstimate", "=", "0"}], ";", "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
         "\:0421\:043a\:0430\:043d\:0438\:0440\:0443\:0435\:043c", " ", 
          "\:0432\:0441\:0435", " ", 
          "\:043d\:0435\:0431\:0430\:0437\:0438\:0441\:043d\:044b\:0435", " ",
           "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0435"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"locI", "=", "1"}], ",", 
          RowBox[{"locI", "\[LessEqual]", "locRowsCount"}], ",", 
          RowBox[{"locI", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"locJ", "=", "1"}], ",", 
            RowBox[{"locJ", "\[LessEqual]", "locColsCount"}], ",", 
            RowBox[{"locJ", "++"}], ",", "\[IndentingNewLine]", 
            "                                                                 \
 ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "\:0412\:044b\:0447\:0438\:0441\:043b\:044f\:0435\:0442\:0441\
\:044f", " ", "\:043e\:0446\:0435\:043d\:043a\:0430", " ", "\:0438", " ", 
               "\:0441\:0440\:0430\:043d\:0438\:0432\:0430\:0435\:0442\:0441\
\:044f", " ", "\:0441", " ", 
               RowBox[{
               "\:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\
\:043e\:0439", ".", "\:0415\:0441\:043b\:0438"}], " ", 
               "\:0431\:043e\:043b\:044c\:0448\:0435", " ", 
               "\:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\
\:043e\:0439", " ", "\:043e\:0446\:0435\:043d\:043a\:0438"}], ",", 
              RowBox[{
              "\:0442\:043e", " ", 
               "\:0437\:0430\:043f\:043e\:043c\:0438\:043d\:0430\:0435\:0442\
\:0441\:044f", " ", "\:043d\:043e\:0432\:0430\:044f"}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"inBasis", "[", 
                RowBox[{"[", 
                 RowBox[{"locI", ",", "locJ"}], "]"}], "]"}], "\[Equal]", 
               "0"}], ",", "\[IndentingNewLine]", 
              "                                                               \
        ", 
              RowBox[{"(*", 
               RowBox[{"Ui", "+", "Uj", "-", "Cij"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"locEstimate", "=", 
                RowBox[{
                 RowBox[{"locPotentials", "[", 
                  RowBox[{"[", "locI", "]"}], "]"}], "+", 
                 RowBox[{"locPotentials", "[", 
                  RowBox[{"[", 
                   RowBox[{"locRowsCount", "+", "locJ"}], "]"}], "]"}], "-", 
                 RowBox[{"inTT", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "locJ"}], "]"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               "                                                              \
         ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "\:0415\:0441\:043b\:0438", " ", 
                  "\:043d\:0430\:0439\:0434\:0435\:043d\:043d\:0430\:044f", 
                  " ", "\:043e\:0446\:0435\:043d\:043a\:0430", " ", 
                  "\:043f\:043e\:043b\:043e\:0436\:0438\:0442\:0435\:043b\
\:044c\:043d\:0430", " ", "\:0438", " ", 
                  "\:0431\:043e\:043b\:044c\:0448\:0435", " ", 
                  "\:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\
\:043d\:043e\:0439"}], ",", " ", 
                 RowBox[{
                 "\:0442\:043e", " ", "\:043e\:043d\:0430", " ", 
                  "\:0441\:0442\:0430\:043d\:043e\:0432\:0438\:0442\:0441\
\:044f", " ", 
                  "\:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\
\:043d\:043e\:0439"}], ",", " ", 
                 RowBox[{
                 "\:0430", " ", 
                  "\:0441\:043e\:043e\:0442\:0432\:0435\:0442\:0441\:0442\
\:0432\:0443\:044e\:0449\:0430\:044f", " ", 
                  "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0430\
\:044f", " ", 
                  "\:043f\:0440\:0435\:0434\:043f\:043e\:043b\:043e\:0436\
\:0438\:0442\:0435\:043b\:044c\:043d\:043e", " ", 
                  "\:0431\:0430\:0437\:0438\:0441\:043d\:043e\:0439"}]}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"locEstimate", ">", "0"}], "&&", 
                  RowBox[{"locEstimate", ">", "locMaxEstimate"}]}], ",", 
                 RowBox[{
                  RowBox[{"locNewBasisVarRow", "=", "locI"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"locNewBasisVarCol", "=", "locJ"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"locMaxEstimate", "=", "locEstimate"}]}]}], 
                "]"}]}]}], "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0415\:0441\:043b\:0438", " ", 
           "\:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\:0430\
\:044f", " ", "\:043e\:0446\:0435\:043d\:043a\:0430", " ", 
           "\:0442\:0430\:043a", " ", "\:0438", " ", 
           "\:043e\:0441\:0442\:0430\:043b\:0430\:0441\:044c", " ", 
           "\:0440\:0430\:0432\:043d\:043e\:0439", " ", 
           "\:043d\:0443\:043b\:044e"}], ",", 
          RowBox[{
          "\:0442\:043e", " ", 
           "\:043e\:043f\:0442\:0438\:043c\:0430\:043b\:044c\:043d\:043e\:0435\
", " ", "\:0440\:0435\:0448\:0435\:043d\:0438\:0435", " ", 
           "\:0443\:0436\:0435", " ", 
           "\:043d\:0430\:0439\:0434\:0435\:043d\:043e"}], ",", 
          RowBox[{
           RowBox[{
           "\:0432\:0432\:043e\:0434\:0438\:0442\:044c", " ", "\:0432", " ", 
            "\:0431\:0430\:0437\:0438\:0441", " ", 
            "\:0431\:043e\:043b\:044c\:0448\:0435", " ", 
            RowBox[{
            "\:043d\:0435\:0447\:0435\:0433\:043e", ".", 
             "\:0418\:043d\:0430\:0447\:0435"}]}], "-", 
           RowBox[{
           "\:043d\:0430\:0439\:0434\:0435\:043d\:0430", " ", 
            "\:043d\:043e\:0432\:0430\:044f", " ", 
            "\:0431\:0430\:0437\:0438\:0441\:043d\:0430\:044f", " ", 
            "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0430\:044f"}]}]\
}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"locMaxEstimate", "\[Equal]", "0"}], ",", 
          RowBox[{"locResult", "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"locResult", "=", 
           RowBox[{"{", 
            RowBox[{"locNewBasisVarRow", ",", "locNewBasisVarCol"}], 
            "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
         "\:0412\:043e\:0437\:0432\:0440\:0430\:0449\:0430\:0435\:043c", " ", 
          "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:0443", " ",
           "\:043d\:043e\:0432\:043e\:0439", " ", 
          "\:0431\:0430\:0437\:0438\:0441\:043d\:043e\:0439", " ", 
          "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439"}], 
         "*)"}], "\[IndentingNewLine]", "locResult"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "                                                                       ", 
   RowBox[{"(*", 
    RowBox[{
    "\:0420\:0435\:043a\:0443\:0440\:0441\:0438\:0432\:043d\:0430\:044f", " ",
      "\:043f\:0440\:043e\:0446\:0435\:0434\:0443\:0440\:0430", " ", 
     "\:043d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:044f", " ", 
     "\:0437\:0430\:043c\:043a\:043d\:0443\:0442\:043e\:0433\:043e", " ", 
     "\:0446\:0438\:043a\:043b\:0430"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"fnFindCycle", "[", 
      RowBox[{
      "inBasis_", ",", "inStartRow_", ",", "inStartCol_", ",", 
       "inCurrentNodeRow_", ",", "inCurrentNodeCol_", ",", 
       "inBlockDirection_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locRowsCount", ",", "locColsCount", ",", "locResult", ",", "locI", 
         ",", "locFlatList"}], "}"}], ",", 
       RowBox[{
        RowBox[{"locRowsCount", "=", 
         RowBox[{"Length", "[", "inBasis", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locColsCount", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"inBasis", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0415\:0441\:043b\:0438", " ", 
           "\:0434\:043e\:0441\:0442\:0438\:0433\:043b\:0438", " ", 
           "\:043d\:0430\:0447\:0430\:043b\:044c\:043d\:043e\:0439", " ", 
           "\:0442\:043e\:0447\:043a\:0438"}], "-", 
          RowBox[{
          "\:043d\:0430\:0447\:0430\:0442\:044c", " ", 
           "\:0432\:043e\:0437\:0432\:0440\:0430\:0449\:0435\:043d\:0438\:0435\
"}]}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"inStartRow", "\[Equal]", "inCurrentNodeRow"}], "&&", 
           RowBox[{"inStartCol", "\[Equal]", "inCurrentNodeCol"}], "&&", 
           RowBox[{"inBlockDirection", "\[NotEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:041d\:0435\:043e\:0431\:0445\:043e\:0434\:0438\:043c\:043e", " ",
            "\:043d\:0430\:0439\:0442\:0438", " ", 
           "\:0446\:0438\:043a\:043b"}], ",", " ", 
          RowBox[{
          "\:043a\:043e\:0442\:043e\:0440\:044b\:0439", " ", 
           "\:043d\:0430\:0447\:0438\:043d\:0430\:0435\:0442\:0441\:044f", 
           " ", "\:0438", " ", 
           "\:0437\:0430\:043a\:0430\:043d\:0447\:0438\:0432\:0430\:0435\:0442\
\:0441\:044f", " ", "\:0432\:044b\:0431\:0440\:0430\:043d\:043d\:043e\:0439", 
           " ", "\:043d\:0435\:0431\:0430\:0437\:0438\:0441\:043d\:043e\:0439\
", " ", "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ", 
           "\:0438", " ", "\:0441\:043e\:0441\:0442\:043e\:0438\:0442", " ", 
           "\:0438\:0437", " ", 
           "\:043f\:043e\:0441\:043b\:0435\:0434\:043e\:0432\:0430\:0442\:0435\
\:043b\:044c\:043d\:043e\:0441\:0442\:0435\:0439", " ", 
           "\:0433\:043e\:0440\:0438\:0437\:043e\:043d\:0442\:0430\:043b\:044c\
\:043d\:044b\:0445", " ", "\:0438", " ", 
           "\:0432\:0435\:0440\:0442\:0438\:043a\:0430\:043b\:044c\:043d\:044b\
\:0445", " ", "\:0441\:0432\:044f\:0437\:0430\:043d\:043d\:044b\:0445", " ", 
           "\:043e\:0442\:0440\:0435\:0437\:043a\:043e\:0432"}], ",", 
          RowBox[{
          "\:043a\:043e\:043d\:0446\:0430\:043c\:0438", " ", 
           "\:043a\:043e\:0442\:043e\:0440\:044b\:0445", " ", 
           "\:0434\:043e\:043b\:0436\:043d\:044b", " ", 
           "\:0431\:044b\:0442\:044c", " ", 
           "\:0431\:0430\:0437\:0438\:0441\:043d\:044b\:0435", " ", 
           "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0435"}], 
          ",", 
          RowBox[{
          "\:0441\:0442\:043e\:044f\:0449\:0438\:0435", " ", 
           "\"\<\:043d\:0430 \:0438\:0437\:043b\:043e\:043c\:0435\>\"", " ", 
           "\:0446\:0438\:043a\:043b\:0430"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:041e\:0441\:0443\:0449\:0435\:0441\:0442\:0432\:0438\:0442\:044c\
", " ", "\:043f\:043e\:0438\:0441\:043a", " ", 
           "\:0432\:043f\:0440\:0430\:0432\:043e"}], ",", 
          RowBox[{
          "\:0435\:0441\:043b\:0438", " ", 
           "\:043d\:0430\:043f\:0440\:0430\:0432\:043b\:0435\:043d\:0438\:0435\
", " ", "\:043d\:0435", " ", 
           "\:0437\:0430\:043f\:0440\:0435\:0449\:0435\:043d\:043e", " ", 
           RowBox[{"(", 
            RowBox[{
            "\:0435\:0441\:043b\:0438", " ", "\:043c\:044b", " ", 
             "\:0442\:043e\:043b\:044c\:043a\:043e", " ", 
             "\:0447\:0442\:043e", " ", "\:043d\:0435", " ", 
             "\:043f\:0440\:0438\:0448\:043b\:0438", " ", 
             "\:043e\:0442\:0442\:0443\:0434\:0430"}], ")"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inBlockDirection", "\[NotEqual]", "1"}], ",", 
          "\[IndentingNewLine]", 
          "                                                                   \
    ", 
          RowBox[{"(*", 
           RowBox[{
           "\:041f\:0440\:043e\:0441\:043c\:0430\:0442\:0440\:0438\:0432\:0430\
\:0435\:043c", " ", "\:0432\:0441\:0435", " ", "\:0443\:0437\:043b\:044b", 
            " ", "\:0432", " ", "\:0434\:0430\:043d\:043d\:043e\:043c", " ", 
            "\:043d\:0430\:043f\:0440\:0430\:0432\:043b\:0435\:043d\:0438\
\:0438"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"locI", "=", 
              RowBox[{"inCurrentNodeCol", "+", "1"}]}], ",", 
             RowBox[{"locI", "\[LessEqual]", "locColsCount"}], ",", 
             RowBox[{"locI", "++"}], ",", "\[IndentingNewLine]", 
             "                                                                \
       ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "\:0415\:0441\:043b\:0438", " ", 
                "\:0431\:0430\:0437\:0438\:0441\:043d\:0430\:044f", " ", 
                "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0430\:044f\
", " ", "\:043d\:0430\:0439\:0434\:0435\:043d\:0430"}], ",", "\:0442\:043e"}],
               "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"inBasis", "[", 
                  RowBox[{"[", 
                   RowBox[{"inCurrentNodeRow", ",", "locI"}], "]"}], "]"}], 
                 "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
                "                                                             \
          ", 
                RowBox[{"(*", 
                 RowBox[{
                 "\:041f\:044b\:0442\:0430\:0442\:044c\:0441\:044f", " ", 
                  "\:043d\:0430\:0439\:0442\:0438", " ", 
                  "\:043f\:0443\:0442\:044c", " ", "\:0432", " ", 
                  "\:044d\:0442\:043e\:043c", " ", 
                  "\:043d\:0430\:043f\:0440\:0430\:0432\:043b\:0435\:043d\
\:0438\:0438"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"locResult", "=", 
                  RowBox[{"fnFindCycle", "[", 
                   RowBox[{
                   "inBasis", ",", "inStartRow", ",", "inStartCol", ",", 
                    "inCurrentNodeRow", ",", "locI", ",", "3"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"locFlatList", "=", 
                  RowBox[{"Flatten", "[", "locResult", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 "                                                            \
           ", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{
                   "\:0415\:0441\:043b\:0438", " ", "\:0431\:044b\:043b", " ",
                     "\:0432\:043e\:0437\:0432\:0440\:0430\:0449\:0451\:043d",
                     " ", "\:0440\:0435\:0437\:0443\:043b\:044c\:0442\:0430\
\:0442", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{
                   "\:0437\:043d\:0430\:0447\:0438\:0442", " ", 
                    "\:0446\:0438\:043a\:043b", " ", 
                    "\:0437\:0430\:043c\:043a\:043d\:0443\:043b\:0441\:044f"}]\
, ",", 
                   RowBox[{
                   "\:0438", " ", "\:043c\:043e\:0436\:043d\:043e", " ", 
                    "\:043d\:0430\:0447\:0438\:043d\:0430\:0442\:044c", " ", 
                    "\:0444\:043e\:0440\:043c\:0438\:0440\:043e\:0432\:0430\
\:043d\:0438\:0435", " ", "\:0441\:043f\:0438\:0441\:043a\:0430", " ", 
                    "\:0432\:0435\:0440\:0448\:0438\:043d"}]}], "*)"}], 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"locFlatList", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 "                                                            \
           ", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{
                   "\:0415\:0441\:043b\:0438", " ", "\:0431\:044b\:043b", " ",
                     "\:0432\:043e\:0437\:0432\:0440\:0430\:0449\:0451\:043d",
                     " ", "\:0440\:0435\:0437\:0443\:043b\:044c\:0442\:0430\
\:0442", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], ",", 
                   RowBox[{
                   "\:0442\:043e", " ", "\:0432", " ", 
                    "\:044d\:0442\:043e\:043c", " ", 
                    "\:043d\:0430\:043f\:0440\:0430\:0432\:043b\:0435\:043d\
\:0438\:0438", " ", "\:043f\:0443\:0442\:0438", " ", "\:043d\:0435\:0442"}], 
                   ",", 
                   RowBox[{"\:0438\:043d\:0430\:0447\:0435", "-", 
                    RowBox[{
                    "\:0434\:043e\:0431\:0430\:0432\:0438\:0442\:044c", " ", 
                    "\:043e\:0447\:0435\:0440\:0435\:0434\:043d\:043e\:0439", 
                    " ", "\:0443\:0437\:0435\:043b", " ", "\:0432", " ", 
                    "\:0446\:0438\:043a\:043b"}]}]}], "*)"}], 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"locFlatList", "\[NotEqual]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "&&", 
                    RowBox[{"inBlockDirection", "\[NotEqual]", "3"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"locResult", ",", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}]}], "]"}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], 
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
         "\:041e\:0441\:0443\:0449\:0435\:0441\:0442\:0432\:0438\:0442\:044c",
           " ", "\:043f\:043e\:0438\:0441\:043a", " ", 
          "\:0432\:043d\:0438\:0437"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inBlockDirection", "\[NotEqual]", "2"}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"locI", "=", 
              RowBox[{"inCurrentNodeRow", "+", "1"}]}], ",", 
             RowBox[{"locI", "\[LessEqual]", "locRowsCount"}], ",", 
             RowBox[{"locI", "++"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"inBasis", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "inCurrentNodeCol"}], "]"}], "]"}], 
                 "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"locResult", "=", 
                  RowBox[{"fnFindCycle", "[", 
                   RowBox[{
                   "inBasis", ",", "inStartRow", ",", "inStartCol", ",", 
                    "locI", ",", "inCurrentNodeCol", ",", "4"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"locFlatList", "=", 
                  RowBox[{"Flatten", "[", "locResult", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"locFlatList", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"locFlatList", "\[NotEqual]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "&&", 
                    RowBox[{"inBlockDirection", "\[NotEqual]", "4"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"locResult", ",", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}]}], "]"}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], 
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
         "\:041e\:0441\:0443\:0449\:0435\:0441\:0442\:0432\:0438\:0442\:044c",
           " ", "\:043f\:043e\:0438\:0441\:043a", " ", 
          "\:0432\:043b\:0435\:0432\:043e"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inBlockDirection", "\[NotEqual]", "3"}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"locI", "=", 
              RowBox[{"inCurrentNodeCol", "-", "1"}]}], ",", 
             RowBox[{"locI", "\[GreaterEqual]", "1"}], ",", 
             RowBox[{"locI", "--"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"inBasis", "[", 
                  RowBox[{"[", 
                   RowBox[{"inCurrentNodeRow", ",", "locI"}], "]"}], "]"}], 
                 "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"locResult", "=", 
                  RowBox[{"fnFindCycle", "[", 
                   RowBox[{
                   "inBasis", ",", "inStartRow", ",", "inStartCol", ",", 
                    "inCurrentNodeRow", ",", "locI", ",", "1"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"locFlatList", "=", 
                  RowBox[{"Flatten", "[", "locResult", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"locFlatList", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"locFlatList", "\[NotEqual]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "&&", 
                    RowBox[{"inBlockDirection", "\[NotEqual]", "1"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"locResult", ",", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}]}], "]"}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], 
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
         "\:041e\:0441\:0443\:0449\:0435\:0441\:0442\:0432\:0438\:0442\:044c",
           " ", "\:043f\:043e\:0438\:0441\:043a", " ", 
          "\:0432\:0432\:0435\:0440\:0445"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inBlockDirection", "\[NotEqual]", "4"}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"locI", "=", 
              RowBox[{"inCurrentNodeRow", "-", "1"}]}], ",", 
             RowBox[{"locI", "\[GreaterEqual]", "1"}], ",", 
             RowBox[{"locI", "--"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"inBasis", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "inCurrentNodeCol"}], "]"}], "]"}], 
                 "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"locResult", "=", 
                  RowBox[{"fnFindCycle", "[", 
                   RowBox[{
                   "inBasis", ",", "inStartRow", ",", "inStartCol", ",", 
                    "locI", ",", "inCurrentNodeCol", ",", "2"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"locFlatList", "=", 
                  RowBox[{"Flatten", "[", "locResult", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"locFlatList", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"locFlatList", "\[NotEqual]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "&&", 
                    RowBox[{"inBlockDirection", "\[NotEqual]", "2"}]}], ",", 
                   RowBox[{
                    RowBox[{"Return", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"locResult", ",", 
                    RowBox[{"{", 
                    RowBox[{"inCurrentNodeRow", ",", "inCurrentNodeCol"}], 
                    "}"}]}], "]"}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], 
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   "                                                                       ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "\:041d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:0435", " ", 
      "\:0432\:044b\:0432\:043e\:0434\:0438\:043c\:043e\:0439", " ", 
      "\:0438\:0437", " ", "\:0431\:0430\:0437\:0438\:0441\:0430", " ", 
      "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ", 
      "\:0430\:043d\:0430\:043b\:0438\:0437\:0438\:0440\:0443\:044f", " ", 
      "\:0446\:0438\:043a\:043b"}], ",", 
     RowBox[{
     "\:0441\:043e\:0434\:0435\:0440\:0436\:0430\:0449\:0438\:0439", " ", 
      "\:0432\:0432\:043e\:0434\:0438\:043c\:0443\:044e", " ", 
      "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0443\:044e", " ", 
      "\:0438", " ", "\:0442\:0435\:043a\:0443\:0449\:0438\:0439", " ", 
      "\:0431\:0430\:0437\:0438\:0441"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fnRemoveBasisVar", "[", 
      RowBox[{"inCycle_", ",", "inBasis_", ",", "inValues_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locMinBasisVarValue", ",", "locVarToRemoveRow", ",", 
         "locVarToRemoveCol", ",", "locBasis", ",", "locValues", ",", "locI", 
         ",", "locCycleLength"}], "}"}], ",", "\[IndentingNewLine]", 
       "                                                                      \
 ", 
       RowBox[{"(*", 
        RowBox[{
        "\:0418\:0437\:043d\:0430\:0447\:0430\:043b\:044c\:043d\:043e", ",", 
         RowBox[{
         "\:0432\:044b\:0432\:043e\:0434\:0438\:043c\:043e\:0439", " ", 
          "\:0438\:0437", " ", "\:0431\:0430\:0437\:0438\:0441\:0430", " ", 
          "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ",
           "\:0441\:0447\:0438\:0442\:0430\:0435\:043c", " ", 
          "\:043f\:0435\:0440\:0432\:0443\:044e", " ", 
          "\:0432\:0435\:0440\:0448\:0438\:043d\:0443"}], ",", 
         RowBox[{
         "\:0432", " ", "\:043a\:043e\:0442\:043e\:0440\:043e\:0439", " ", 
          "\:043f\:0440\:043e\:0438\:0441\:0445\:043e\:0434\:0438\:0442", " ",
           "\:0443\:043c\:0435\:043d\:044c\:0448\:0435\:043d\:0438\:0435", 
          " ", "\:0437\:043d\:0430\:0447\:0435\:043d\:0438\:044f", " ", 
          "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439"}]}], 
        "*)"}], 
       RowBox[{
        RowBox[{"locMinBasisVarValue", "=", 
         RowBox[{"inValues", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"inCycle", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"inCycle", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locVarToRemoveRow", "=", 
         RowBox[{"inCycle", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locVarToRemoveCol", "=", 
         RowBox[{"inCycle", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locBasis", "=", "inBasis"}], ";", "\[IndentingNewLine]", 
        RowBox[{"locValues", "=", "inValues"}], ";", "\[IndentingNewLine]", 
        "                                                                     \
  ", 
        RowBox[{"(*", 
         RowBox[{
         "\:041f\:0440\:043e\:0441\:043a\:0430\:043d\:0438\:0440\:043e\:0432\
\:0430\:043b\:0438", " ", "\:0432\:0441\:0435", " ", 
          "\:0443\:043c\:0435\:043d\:044c\:0448\:0430\:0435\:043c\:044b\:0435\
", " ", "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0435", " ", 
          "\:0432", " ", "\:043f\:043e\:0438\:0441\:043a\:0430\:0445", " ", 
          
          "\:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\:043e\:0439\
"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"locI", "=", "3"}], ";", "\[IndentingNewLine]", 
        RowBox[{"locCycleLength", "=", 
         RowBox[{"Length", "[", "inCycle", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"locI", "\[LessEqual]", "locCycleLength"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"inValues", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
              "<", "locMinBasisVarValue"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"locMinBasisVarValue", "=", 
               RowBox[{"inValues", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"inCycle", "[", 
                   RowBox[{"[", 
                    RowBox[{"locI", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"inCycle", "[", 
                   RowBox[{"[", 
                    RowBox[{"locI", ",", "2"}], "]"}], "]"}]}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"locVarToRemoveRow", "=", 
               RowBox[{"inCycle", "[", 
                RowBox[{"[", 
                 RowBox[{"locI", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"locVarToRemoveCol", "=", 
               RowBox[{"inCycle", "[", 
                RowBox[{"[", 
                 RowBox[{"locI", ",", "2"}], "]"}], "]"}]}], ";"}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"locI", "+=", "2"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "                                                                    \
   ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\:0421\:043a\:043e\:0440\:0440\:0435\:043a\:0442\:0438\:0440\:043e\
\:0432\:0430\:043b\:0438", " ", 
           "\:0437\:043d\:0430\:0447\:0435\:043d\:0438\:044f", " ", 
           "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0445"}], 
          ",", 
          RowBox[{
          "\:0447\:0435\:0440\:0435\:0437", " ", "\:043e\:0434\:043d\:0443", 
           " ", "\:0443\:043c\:0435\:043d\:044c\:0448\:0430\:0435\:043c"}], 
          ",", 
          RowBox[{
          "\:0447\:0435\:0440\:0435\:0437", " ", "\:043e\:0434\:043d\:0443", 
           " ", "\:0443\:0432\:0435\:043b\:0438\:0447\:0438\:0432\:0430\:0435\
\:043c"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"locI", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"locI", "\[LessEqual]", "locCycleLength"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Floor", "[", 
               RowBox[{"locI", "/", "2."}], "]"}], "\[Equal]", 
              RowBox[{"locI", "/", "2."}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"locValues", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], "+=",
               "locMinBasisVarValue"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"locValues", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"inCycle", "[", 
                  RowBox[{"[", 
                   RowBox[{"locI", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], "-=",
               "locMinBasisVarValue"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"locI", "++"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]",
         "                                                                    \
  ", 
        RowBox[{"(*", 
         RowBox[{
         "\:0412\:044b\:0432\:043e\:0434\:0438\:043c", " ", "\:0438\:0437", 
          " ", "\:0431\:0430\:0437\:0438\:0441\:0430", " ", 
          "\:0441\:0442\:0430\:0440\:0443\:044e", " ", 
          "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0443\:044e"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"locBasis", "[", 
          RowBox[{"[", 
           RowBox[{"locVarToRemoveRow", ",", "locVarToRemoveCol"}], "]"}], 
          "]"}], "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"locBasis", ",", "locValues"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "                                                                      ", 
   RowBox[{"(*", 
    RowBox[{
    "\:041d\:0430\:0439\:0442\:0438", " ", 
     "\:0434\:043e\:043f\:0443\:0441\:0442\:0438\:043c\:043e\:0435", " ", 
     "\:043d\:0430\:0447\:0430\:043b\:044c\:043d\:043e\:0435", " ", 
     "\:0431\:0430\:0437\:0438\:0441\:043d\:043e\:0435", " ", 
     "\:0440\:0435\:0448\:0435\:043d\:0438\:0435"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"basis", ",", "values"}], "}"}], "=", 
     RowBox[{"fnFindBasisMinPriceMethod", "[", 
      RowBox[{"TT", ",", "RL", ",", "CL"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"newBasisVarRow", "=", 
     RowBox[{"-", "1"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"newBasisVarCol", "=", 
     RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iterations", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{
     "True", ",", "\[IndentingNewLine]", 
      "                                                                      \
", 
      RowBox[{"(*", 
       RowBox[{
       "\:041d\:0430\:0439\:0442\:0438", " ", 
        "\:043d\:043e\:0432\:0443\:044e", " ", 
        "\:0431\:0430\:0437\:0438\:0441\:043d\:0443\:044e", " ", 
        "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0443\:044e"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newBasisVarRow", ",", "newBasisVarCol"}], "}"}], "=", 
        RowBox[{"fnFindNextBasisVar", "[", 
         RowBox[{"TT", ",", "basis"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "                                                                      \
 ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "\:0415\:0441\:043b\:0438", " ", 
          "\:0440\:0435\:0437\:0443\:043b\:044c\:0442\:0430\:0442", " ", 
          "\:0432\:043e\:0437\:0432\:0440\:0430\:0449\:0435\:043d\:0438\:044f\
", " ", "\:0444\:0443\:043d\:043a\:0446\:0438\:0438", " ", 
          "\:043f\:043e\:0438\:0441\:043a\:0430", " ", 
          "\:043d\:043e\:0432\:043e\:0439", " ", 
          "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], 
          RowBox[{"(", 
           RowBox[{
           "\:043d\:0435", " ", 
            "\:043e\:0441\:0442\:0430\:043b\:043e\:0441\:044c", " ", 
            "\:043f\:043e\:043b\:043e\:0436\:0438\:0442\:0435\:043b\:044c\
\:043d\:044b\:0445", " ", "\:043e\:0446\:0435\:043d\:043e\:043a"}], ")"}]}], 
         ",", " ", 
         RowBox[{
         "\:0442\:043e", " ", 
          
          "\:043e\:043f\:0442\:0438\:043c\:0430\:043b\:044c\:043d\:043e\:0435\
", " ", "\:0440\:0448\:0435\:043d\:0438\:0435", " ", "\:0443\:0436\:0435", 
          " ", "\:043d\:0430\:0439\:0434\:0435\:043d\:043e"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"newBasisVarRow", ",", "newBasisVarCol"}], "}"}], 
          "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "                                                                      \
 ", 
       RowBox[{"(*", 
        RowBox[{
        "\:0412\:0432\:043e\:0434\:0438\:043c", " ", 
         "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0443\:044e", " ", 
         "\:0432", " ", "\:0431\:0430\:0437\:0438\:0441"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"basis", "[", 
         RowBox[{"[", 
          RowBox[{"newBasisVarRow", ",", "newBasisVarCol"}], "]"}], "]"}], 
        "=", "1"}], ";", "\[IndentingNewLine]", 
       "                                                                      \
", 
       RowBox[{"(*", 
        RowBox[{
        "\:041d\:0430\:0439\:0442\:0438", " ", "\:0446\:0438\:043a\:043b"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cycle", "=", 
        RowBox[{"fnFindCycle", "[", 
         RowBox[{
         "basis", ",", "newBasisVarRow", ",", "newBasisVarCol", ",", 
          "newBasisVarRow", ",", "newBasisVarCol", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       "                                                                      \
", 
       RowBox[{"(*", 
        RowBox[{
        "\:0423\:0434\:0430\:043b\:0438\:0442\:044c", " ", 
         "\:043b\:0438\:0448\:043d\:044e\:044e", " ", 
         "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:0443\:044e", " ", 
         "\:0438\:0437", " ", "\:0431\:0430\:0437\:0438\:0441\:0430"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"basis", ",", "values"}], "}"}], "=", 
        RowBox[{"fnRemoveBasisVar", "[", 
         RowBox[{"cycle", ",", "basis", ",", "values"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"iterations", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "                                                                      ", 
   RowBox[{"(*", 
    RowBox[{
    "\:0412\:044b\:0447\:0438\:0441\:043b\:0438\:0442\:044c", " ", 
     "\:043e\:043f\:0442\:0438\:043c\:0430\:043b\:044c\:043d\:043e\:0435", 
     " ", "\:0437\:043d\:0430\:0447\:0435\:043d\:0438\:0435", " ", 
     "\:0444\:0443\:043d\:043a\:0446\:0438\:0438"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"functionValue", "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", "rowsCount"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", "colsCount"}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{
          RowBox[{"functionValue", "+=", 
           RowBox[{
            RowBox[{"TT", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
            RowBox[{"values", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], "]"}], 
       ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"MatrixForm", "[", "TT", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\:0417\:043d\:0430\:0447\:0435\:043d\:0438\:0435 \:0446\:0435\:043b\
\:0435\:0432\:043e\:0439 \:0444\:0443\:043d\:043a\:0446\:0438\:0438 = \>\"", "<>", 
      RowBox[{"ToString", "[", "functionValue", "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
    "Print", "[", 
     "\"\<\:0411\:0430\:0437\:0438\:0441 \:043f\:0435\:0440\:0435\:043c\:0435\
\:043d\:043d\:044b\:0445\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"MatrixForm", "[", "basis", "]"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
    "Print", "[", 
     "\"\<\:0417\:043d\:0430\:0447\:0435\:043d\:0438\:044f \:043f\:0435\:0440\
\:0435\:043c\:0435\:043d\:043d\:044b\:0445\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"MatrixForm", "[", "values", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\:0427\:0438\:0441\:043b\:043e \:0438\:0442\:0435\:0440\:0430\:0446\
\:0438\:0439: \>\"", ",", " ", "iterations"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.732368645394146*^9, 3.732368659049927*^9}, 
   3.732368895210435*^9, {3.732369156264366*^9, 3.732369219725996*^9}, {
   3.732369250454754*^9, 3.7323692564340954`*^9}, {3.732405335294332*^9, 
   3.7324053470090017`*^9}, {3.732405728741836*^9, 3.7324057371603174`*^9}, {
   3.732405845844534*^9, 3.7324058907361016`*^9}, {3.732406023795712*^9, 
   3.732406037100473*^9}, {3.7324060672341967`*^9, 3.7324060784088354`*^9}, {
   3.732406111755743*^9, 3.73240614125743*^9}, {3.7324061921233397`*^9, 
   3.7324061974686456`*^9}, {3.732406246488449*^9, 3.7324062879428205`*^9}, {
   3.7324063325273705`*^9, 3.732406354269614*^9}, {3.7324063896546383`*^9, 
   3.7324063936858683`*^9}, {3.732406483895028*^9, 3.73240649896089*^9}, {
   3.7324065678908324`*^9, 3.7324065709530077`*^9}, {3.7324066232079964`*^9, 
   3.732406628635307*^9}, {3.7324066758060045`*^9, 3.7324066918819246`*^9}, {
   3.732406734358354*^9, 3.73240673446636*^9}, {3.73240677257854*^9, 
   3.732406849039913*^9}, {3.732406987501833*^9, 3.7324069886919007`*^9}, {
   3.732407035494578*^9, 3.7324070751578465`*^9}, 3.7324311010720425`*^9, {
   3.732431154141078*^9, 3.7324311771143923`*^9}, {3.732431219119795*^9, 
   3.732431241658084*^9}, {3.7324312720408216`*^9, 3.7324312891217985`*^9}, {
   3.7324450060831337`*^9, 3.7324450117774596`*^9}, {3.7324450440723066`*^9, 
   3.732445051280719*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "2", "3", "4", "6", "8", "0"},
     {"2", "2", "0", "2", "4", "6", "0"},
     {"4", "4", "2", "0", "2", "2", "0"},
     {"6", "6", "4", "4", "2", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.7323691629417477`*^9, 3.732406411667897*^9, 3.732406580481553*^9, 
   3.7324066400789614`*^9, 3.732406695244117*^9, 3.732406757925702*^9, 
   3.732406789563512*^9, 3.732407088370602*^9, 3.7324317725514493`*^9, {
   3.732445028800433*^9, 3.73244505602499*^9}}],

Cell[BoxData["\<\"\:0417\:043d\:0430\:0447\:0435\:043d\:0438\:0435 \:0446\
\:0435\:043b\:0435\:0432\:043e\:0439 \:0444\:0443\:043d\:043a\:0446\:0438\
\:0438 = 560\"\>"], "Print",
 CellChangeTimes->{
  3.7323691629417477`*^9, 3.732406411667897*^9, 3.732406580481553*^9, 
   3.7324066400789614`*^9, 3.732406695244117*^9, 3.732406757925702*^9, 
   3.732406789563512*^9, 3.732407088370602*^9, 3.7324317725514493`*^9, {
   3.732445028800433*^9, 3.732445056031991*^9}}],

Cell[BoxData["\<\"\:0411\:0430\:0437\:0438\:0441 \:043f\:0435\:0440\:0435\
\:043c\:0435\:043d\:043d\:044b\:0445\"\>"], "Print",
 CellChangeTimes->{
  3.7323691629417477`*^9, 3.732406411667897*^9, 3.732406580481553*^9, 
   3.7324066400789614`*^9, 3.732406695244117*^9, 3.732406757925702*^9, 
   3.732406789563512*^9, 3.732407088370602*^9, 3.7324317725514493`*^9, {
   3.732445028800433*^9, 3.7324450560379915`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "0", "0", "0", "0", "1"},
     {"0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "1", "1", "1", "1"},
     {"0", "0", "0", "0", "0", "1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.7323691629417477`*^9, 3.732406411667897*^9, 3.732406580481553*^9, 
   3.7324066400789614`*^9, 3.732406695244117*^9, 3.732406757925702*^9, 
   3.732406789563512*^9, 3.732407088370602*^9, 3.7324317725514493`*^9, {
   3.732445028800433*^9, 3.7324450560429916`*^9}}],

Cell[BoxData["\<\"\:0417\:043d\:0430\:0447\:0435\:043d\:0438\:044f \:043f\
\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0445\"\>"], "Print",
 CellChangeTimes->{
  3.7323691629417477`*^9, 3.732406411667897*^9, 3.732406580481553*^9, 
   3.7324066400789614`*^9, 3.732406695244117*^9, 3.732406757925702*^9, 
   3.732406789563512*^9, 3.732407088370602*^9, 3.7324317725514493`*^9, {
   3.732445028800433*^9, 3.7324450560479918`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"56", "56", "0", "0", "0", "0", "16"},
     {"0", "0", "128", "0", "0", "0", "0"},
     {"0", "0", "128", "64", "32", "64", "224"},
     {"0", "0", "0", "0", "0", "64", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.7323691629417477`*^9, 3.732406411667897*^9, 3.732406580481553*^9, 
   3.7324066400789614`*^9, 3.732406695244117*^9, 3.732406757925702*^9, 
   3.732406789563512*^9, 3.732407088370602*^9, 3.7324317725514493`*^9, {
   3.732445028800433*^9, 3.7324450560539923`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:0427\:0438\:0441\:043b\:043e \:0438\:0442\:0435\:0440\:0430\
\:0446\:0438\:0439: \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm[
  "\:0427\:0438\:0441\:043b\:043e \:0438\:0442\:0435\:0440\:0430\:0446\:0438\
\:0439: ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7323691629417477`*^9, 3.732406411667897*^9, 3.732406580481553*^9, 
   3.7324066400789614`*^9, 3.732406695244117*^9, 3.732406757925702*^9, 
   3.732406789563512*^9, 3.732407088370602*^9, 3.7324317725514493`*^9, {
   3.732445028800433*^9, 3.7324450560589924`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 72055, 1574, 5609, "Input"],
Cell[CellGroupData[{
Cell[72660, 1600, 1002, 24, 65, "Print"],
Cell[73665, 1626, 463, 7, 22, "Print"],
Cell[74131, 1635, 414, 6, 22, "Print"],
Cell[74548, 1643, 1005, 24, 65, "Print"],
Cell[75556, 1669, 432, 6, 22, "Print"],
Cell[75991, 1677, 1018, 24, 65, "Print"],
Cell[77012, 1703, 592, 12, 22, "Print"]
}, Open  ]]
}, Open  ]]
}
]
*)

